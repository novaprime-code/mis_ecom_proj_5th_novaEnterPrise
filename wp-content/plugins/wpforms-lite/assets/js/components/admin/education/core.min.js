"use strict";var WPFormsEducation=window.WPFormsEducation||{};WPFormsEducation.core=window.WPFormsEducation.core||function(t,o,c){var a='<i class="wpforms-loading-spinner wpforms-loading-white wpforms-loading-inline"></i>',s={init:function(){c(s.ready)},ready:function(){s.events()},events:function(){s.dismissEvents(),s.openModalButtonClick(),s.setDykColspan()},openModalButtonClick:function(){c(t).on("click",".education-modal",function(t){var n=c(this);switch(t.preventDefault(),n.data("action")){case"activate":s.activateModal(n);break;case"install":s.installModal(n)}})},dismissEvents:function(){c(t).on("click",".wpforms-dismiss-container .wpforms-dismiss-button",function(t){var n=c(this),o=n.closest(".wpforms-dismiss-container"),e=o.find(".wpforms-dismiss-out"),n={action:"wpforms_education_dismiss",nonce:wpforms_education.nonce,section:n.data("section")};0<(e=o.hasClass("wpforms-dismiss-out")?o:e).length?(e.addClass("out"),setTimeout(function(){o.remove()},300)):o.remove(),c.post(wpforms_education.ajax_url,n)})},setDykColspan:function(){c("#adv-settings").on("change","input.hide-column-tog",function(t){var n=c(".wpforms-dyk td"),o=c(".wp-list-table thead .manage-column").not(".hidden").length;n.attr("colspan",o)})},getUTMContentValue:function(t){return t.hasClass("wpforms-add-fields-button")?t.data("utm-content")+" Field":t.hasClass("wpforms-template-select")?s.slugToUTMcontent(t.data("slug")):t.hasClass("wpforms-panel-sidebar-section")?s.slugToUTMcontent(t.data("slug"))+" Addon":t.data("utm-content")||t.data("name")},slugToUTMcontent:function(t){return t?t.toString().replace(/[^a-z\d ]/gi," ").replace(/\b[a-z]/g,function(t){return t.toUpperCase()}):""},getUpgradeURL:function(t,n){var o=wpforms_education.upgrade[n].url,n=(-1<t.toLowerCase().indexOf("template")&&(o=wpforms_education.upgrade[n].url_template),/(\?)/.test(o)?"&":"?");return-1===o.indexOf("https://wpforms.com")&&(n=encodeURIComponent(n)),o+n+"utm_content="+encodeURIComponent(t.trim())},getSpinner:function(){return a},activateModal:function(t){var n=t.data("name");c.alert({title:!1,content:wpforms_education.activate_prompt.replace(/%name%/g,n),icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_education.activate_confirm,btnClass:"btn-confirm",keys:["enter"],action:function(){return this.$$confirm.prop("disabled",!0).html(a+wpforms_education.activating),this.$$cancel.prop("disabled",!0),s.activateAddon(t,this),!1}},cancel:{text:wpforms_education.cancel}}})},activateAddon:function(n,o){var t=n.data("path"),e=n.data("type"),a=n.data("nonce"),i=n.data("hide-on-success");c.post(wpforms_education.ajax_url,{action:"wpforms_activate_addon",nonce:a,plugin:t,type:e},function(t){o.close(),t.success?(i&&n.hide(),s.saveModal("plugin"===e?wpforms_education.plugin_activated:wpforms_education.addon_activated)):c.alert({title:!1,content:t.data,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}})})},saveModal:function(t,n){t=t||wpforms_education.addon_activated,n=n||wpforms_education.save_prompt,c.alert({title:t.replace(/\.$/,""),content:n,icon:"fa fa-check-circle",type:"green",buttons:{confirm:{text:wpforms_education.save_confirm,btnClass:"btn-confirm",keys:["enter"],action:function(){var t;if("undefined"!=typeof WPFormsBuilder&&(this.$$confirm.prop("disabled",!0).html(a+wpforms_education.saving),this.$$cancel.prop("disabled",!0),!WPFormsBuilder.formIsSaved()))return!(t=WPFormsBuilder.formSave())||(t.done(function(){location.reload()}),!1);location.reload()}},cancel:{text:wpforms_education.close}}})},installModal:function(t){var n=t.data("name"),o=t.data("url"),e=t.data("license");o&&""!==o?c.alert({title:!1,content:wpforms_education.install_prompt.replace(/%name%/g,n),icon:"fa fa-info-circle",type:"blue",boxWidth:"425px",buttons:{confirm:{text:wpforms_education.install_confirm,btnClass:"btn-confirm",keys:["enter"],isHidden:!wpforms_education.can_install_addons,action:function(){return this.$$confirm.prop("disabled",!0).html(a+wpforms_education.installing),this.$$cancel.prop("disabled",!0),s.installAddon(t,this),!1}},cancel:{text:wpforms_education.cancel}}}):s.upgradeModal(n,"","Empty install URL",e,"")},installAddon:function(o,e){var t=o.data("url"),n=o.data("type"),a=o.data("nonce"),i=o.data("hide-on-success");c.post(wpforms_education.ajax_url,{action:"wpforms_install_addon",nonce:a,plugin:t,type:n},function(t){var n;e.close(),t.success?(i&&o.hide(),s.saveModal(t.data.msg,!1)):(n=t.data,"object"==typeof t.data&&(n=wpforms_education.addon_error),c.alert({title:!1,content:n,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}}))})},getUpgradeModalWidth:function(t){var n=c(o).width();return n<=300?"250px":n<=750?"350px":!t||n<=1024?"550px":1070<n?"1040px":"994px"},errorModal:function(t,n){c.alert({title:t||!1,content:n,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}})}};return s}(document,window,jQuery),WPFormsEducation.core.init();