var WPFormsBuilder=window.WPFormsBuilder||function(r,a,w){var m,h,g={},i=!0,l=!1,b={settings:{spinner:'<i class="wpforms-loading-spinner"></i>',spinnerInline:'<i class="wpforms-loading-spinner wpforms-loading-inline"></i>',tinymceDefaults:{tinymce:{toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,link"},quicktags:!0},pagebreakTop:!1,pagebreakBottom:!1,upload_img_modal:!1},init:function(){var e=this;wpforms_panel_switch=!0,m=this.settings,w(b.ready),w(a).on("load",function(){"function"==typeof w.ready.then?w.ready.then(b.load):b.load()}),w(a).on("beforeunload",function(){if(!e.formIsSaved()&&i)return wpforms_builder.are_you_sure_to_close})},load:function(){if(wpf.getQueryString("newform")&&b.formSave(!1),"revisions"===w("#wpforms-panels-toggle .active").data("panel")&&b.updateRevisionPreview(),WPFormsUtils.triggerEvent(h,"wpformsBuilderReady").isDefaultPrevented())return!1;b.hideLoadingOverlay(),"1"==wpforms_builder.template_modal_display&&"fields"===wpf.getQueryString("view")&&w.alert({title:wpforms_builder.template_modal_title,content:wpforms_builder.template_modal_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}}})},ready:function(){b.isVisitedViaBackButton()?location.reload():(h=w("#wpforms-builder"),g.$helpButton=w("#wpforms-help"),g.$previewButton=w("#wpforms-preview-btn"),g.$embedButton=w("#wpforms-embed"),g.$saveButton=w("#wpforms-save"),g.$exitButton=w("#wpforms-exit"),g.$noFieldsOptions=w("#wpforms-panel-fields .wpforms-no-fields-holder .no-fields"),g.$noFieldsPreview=w("#wpforms-panel-fields .wpforms-no-fields-holder .no-fields-preview"),g.$formPreview=w("#wpforms-panel-fields .wpforms-preview-wrap"),g.$revisionPreview=w("#wpforms-panel-revisions .wpforms-panel-content"),g.defaultEmailSelector=".wpforms-field-option-email .wpforms-field-option-row-default_value input",g.$defaultEmail=w(g.defaultEmailSelector),g.$focusOutTarget=null,g.$nextFieldId=w("#wpforms-field-id"),g.$fieldOptions=w("#wpforms-field-options"),g.$fieldsPreviewWrap=w("#wpforms-panel-fields .wpforms-panel-content-wrap"),g.$sortableFieldsWrap=w("#wpforms-panel-fields .wpforms-field-wrap"),g.$addFieldsButtons=w(".wpforms-add-fields-button").not(".not-draggable").not(".warning-modal").not(".education-modal"),b.isBuilderInPopup()&&(g.$embedButton.remove(),g.$previewButton.addClass("wpforms-alone")),b.loadMsWinCSS(),b.bindUIActions(),m.formID=w("#wpforms-builder-form").data("id"),m.pagebreakTop=w(".wpforms-pagebreak-top").length,m.pagebreakBottom=w(".wpforms-pagebreak-bottom").length,h.on("keypress","#wpforms-builder-form :input:not(textarea)",function(e){13===e.keyCode&&e.preventDefault()}),w(".wpforms-panel").each(function(e,i){var o,t=w(this),r=t.find(".wpforms-panel-sidebar-section.configured").first();r.length?(o=r.data("section"),r.addClass("active"),t.find(".wpforms-panel-content-section-"+o).show().addClass("active"),t.find(".wpforms-panel-content-section-default").hide()):(t.find(".wpforms-panel-content-section:first-of-type").show().addClass("active"),t.find(".wpforms-panel-sidebar-section:first-of-type").addClass("active"))}),b.loadEntryPreviewFields(),b.fieldChoiceSortable("select"),b.fieldChoiceSortable("radio"),b.fieldChoiceSortable("checkbox"),b.fieldChoiceSortable("payment-multiple"),b.fieldChoiceSortable("payment-checkbox"),b.fieldChoiceSortable("payment-select"),w(".wpforms-add-fields-group").each(function(e,i){b.fieldGroupToggle(w(this),"load")}),b.registerTemplates(),b.trimFormTitle(),wpf.initTooltips(),b.loadColorPickers(),b.captchaToggle(),b.confirmationsSetup(),b.notificationToggle(),b.notificationsByStatusAlerts(),b.builderHotkeys(),w("#wpforms-setup-name").val(w("#wpforms-panel-field-settings-form_title").val()),jconfirm.defaults={closeIcon:!1,backgroundDismiss:!1,escapeKey:!0,animationBounce:1,useBootstrap:!1,theme:"modern",boxWidth:"400px",animateFromElement:!1,content:wpforms_builder.something_went_wrong},b.dropdownField.init(),b.iconChoices.init(),b.initSomeFieldOptions(),b.dismissNotice())},loadMsWinCSS:function(){var e=navigator.userAgent;e.indexOf("Windows")<0||e.indexOf("Chrome")<0&&e.indexOf("Firefox")<0||w("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:wpforms_builder.ms_win_css_url})},isVisitedViaBackButton:function(){var i;return!!performance&&(i=!1,performance.getEntriesByType("navigation").forEach(function(e){"back_forward"===e.type&&(i=!0)}),i)},hideLoadingOverlay:function(){var e=w("#wpforms-builder-overlay");e.addClass("fade-out"),setTimeout(function(){e.hide()},250)},showLoadingOverlay:function(){var e=w("#wpforms-builder-overlay");e.removeClass("fade-out"),e.show()},initSomeFieldOptions:function(){b.toggleAllOptionGroups(h),h.find(".wpforms-field-option-row-date .type select").trigger("change")},dropdownField:{config:{modernClass:"choicesjs-select",args:{searchEnabled:!1,searchChoices:!1,renderChoiceLimit:1,shouldSort:!1,callbackOnInit:function(){var e=w(this.containerOuter.element),i=e.closest(".wpforms-field").find("select");e.hasClass("is-disabled")&&e.removeClass("is-disabled"),i.is("[readonly]")&&(this.disable(),i.prop("disabled",!1)),this.passedElement.element.multiple&&this.getValue(!0).length&&w(this.input.element).addClass("choices__input--hidden")}}},init:function(){h.find("."+b.dropdownField.config.modernClass).each(function(){b.dropdownField.events.choicesInit(w(this))}),h.on("change",".wpforms-field-option-select .wpforms-field-option-row-multiple input",b.dropdownField.events.multiple),h.on("change",".wpforms-field-option-select .wpforms-field-option-row-style select, .wpforms-field-option-payment-select .wpforms-field-option-row-style select",b.dropdownField.events.applyStyle),h.on("click",".choices",function(e){var i=w(this),o=i.find("select").data("choicesjs");o&&i.hasClass("is-open")&&e.target.classList.contains("choices__inner")&&o.hideDropdown()})},events:{choicesInit:function(e){let i=1===e.data("choicesjs-use-ajax"),o;o="select_pages"===e.data("choicesjs-callback-fn")?WPForms.Admin.Builder.WPFormsChoicesJS.setup(e[0],b.dropdownField.config.args,{action:"wpforms_ajax_search_pages_for_dropdown",nonce:i?wpforms_builder.nonce:null}):new Choices(e[0],b.dropdownField.config.args),b.dropdownField.helpers.setInstance(e,o),b.dropdownField.helpers.addPlaceholderChoice(e,o),e.closest(".choices").toggleClass("wpforms-hidden",!o.config.choices.length)},multiple:function(e){var i=w(this).closest(".wpforms-field-option-row-multiple").data().fieldId,o=b.dropdownField.helpers.getPrimarySelector(i),t=w("#wpforms-field-option-row-"+i+"-choices input.default"),r=o.find(".placeholder"),n=b.dropdownField.helpers.isDynamicChoices(i),e=e.target.checked,s=e?"checkbox":"radio";o.prop("multiple",e),t.prop("type",s),n&&o.find("option:selected").prop("selected",!1),s=t.filter(":checked"),!e&&s.length&&(t.prop("checked",!1),w(s.get(0)).prop("checked",!0)),r.length&&r.prop("selected",!e),b.dropdownField.helpers.update(i,n)},applyStyle:function(){var e=w(this),i=e.closest(".wpforms-field-option-row-style").data().fieldId;"modern"===e.val()?b.dropdownField.helpers.convertClassicToModern(i):b.dropdownField.helpers.convertModernToClassic(i)}},helpers:{convertModernToClassic:function(e){var i=b.dropdownField.helpers.getPrimarySelector(e),o=b.dropdownField.helpers.isDynamicChoices(e),i=b.dropdownField.helpers.getInstance(i);i.destroy(),b.dropdownField.helpers.updatePlaceholderChoice(i,e),o||b.fieldChoiceUpdate("select",e)},convertClassicToModern:function(e){var i=b.dropdownField.helpers.getPrimarySelector(e);b.dropdownField.helpers.isDynamicChoices(e)||b.fieldChoiceUpdate("select",e),b.dropdownField.events.choicesInit(i)},update:function(e,i){var o=b.dropdownField.helpers.getPrimarySelector(e);b.dropdownField.helpers.isModernSelect(o)?(b.dropdownField.helpers.convertModernToClassic(e),b.dropdownField.events.choicesInit(o)):i||b.fieldChoiceUpdate("select",e)},addPlaceholderChoice:function(e,i){var o,t,e=e.closest(".wpforms-field");return!(e.length<=0||(e=e.data().fieldId,o=b.dropdownField.helpers.hasDefaults(e),b.dropdownField.helpers.isDynamicChoices(e)&&(o=!1),!1!==b.dropdownField.helpers.searchPlaceholderChoice(i))||!i.config.choices.length||(e=i.config.choices[0].label,t=w(i.passedElement.element).prop("multiple"),i.setChoices([{value:"",label:e,selected:!(t||o),placeholder:!0}],"value","label",!1),t&&w(i.input.element).prop("placeholder",e),0))},searchPlaceholderChoice:function(e){var t=!1;return e.config.choices.forEach(function(e,i,o){if(void 0!==e.placeholder&&!0===e.placeholder)return!(t={key:i,item:e})}),t},updatePlaceholderChoice:function(e,i){var o=w(e.passedElement.element),i=wpf.sanitizeHTML(w("#wpforms-field-option-"+i+"-placeholder").val()),e=b.dropdownField.helpers.searchPlaceholderChoice(e),t={};"object"==typeof e&&(t=w(o.find("option").get(e.key))),""!==i?!w.isEmptyObject(t)&&t.length?t.addClass("placeholder").text(i):o.prepend('<option value="" class="placeholder">'+i+"</option>"):t.length&&t.remove()},isModernSelect:function(e){e=b.dropdownField.helpers.getInstance(e);return"object"==typeof e&&!w.isEmptyObject(e)&&e.initialised},setInstance:function(e,i){e.data("choicesjs",i)},getInstance:function(e){return e.data("choicesjs")},isDynamicChoices:function(e){e=w("#wpforms-field-option-"+e+"-dynamic_choices");return!!e.length&&""!==e.val()},hasDefaults:function(e){return!!w("#wpforms-field-option-row-"+e+"-choices .choices-list").find("input.default:checked").length},getPrimarySelector:function(e){return w("#wpforms-field-"+e+" .primary-input")}}},numberSliderEvents:function(e){e.on("input",".wpforms-field-option-row-min_max .wpforms-input-row .wpforms-number-slider-min",b.fieldNumberSliderUpdateMin),e.on("input",".wpforms-field-option-row-min_max .wpforms-input-row .wpforms-number-slider-max",b.fieldNumberSliderUpdateMax),e.on("input",".wpforms-number-slider-default-value",_.debounce(b.changeNumberSliderDefaultValue,500)),e.on("input",".wpforms-number-slider-step",_.debounce(b.changeNumberSliderStep,500)),e.on("focusout",".wpforms-number-slider-step",b.checkNumberSliderStep),e.on("input",".wpforms-number-slider-value-display",_.debounce(b.changeNumberSliderValueDisplay,500)),e.on("input",".wpforms-number-slider-min",_.debounce(b.changeNumberSliderMin,500)),e.on("input",".wpforms-number-slider-max",_.debounce(b.changeNumberSliderMax,500))},changeNumberSliderMin:function(e){var i=w(e.target).parents(".wpforms-field-option-row").data("fieldId"),o=parseFloat(e.target.value);isNaN(o)||b.updateNumberSliderDefaultValueAttr(i,e.target.value,"min")},changeNumberSliderMax:function(e){var i=w(e.target).parents(".wpforms-field-option-row").data("fieldId"),o=parseFloat(e.target.value);isNaN(o)||b.updateNumberSliderDefaultValueAttr(i,e.target.value,"max").updateNumberSliderStepValueMaxAttr(i,e.target.value)},changeNumberSliderValueDisplay:function(e){var i=e.target.value,e=w(e.target).parents(".wpforms-field-option-row").data("fieldId"),o=r.getElementById("wpforms-field-option-"+e+"-default_value");o&&b.updateNumberSliderHintStr(e,i).updateNumberSliderHint(e,o.value)},changeNumberSliderStep:function(e){var i,o,t,r=parseFloat(e.target.value);isNaN(r)||(i=parseFloat(e.target.max),o=parseFloat(e.target.min),t=w(e.target).parents(".wpforms-field-option-row").data("fieldId"),r<=0)||(i<r?e.target.value=i:r<o?e.target.value=o:b.updateNumberSliderAttr(t,r,"step").updateNumberSliderDefaultValueAttr(t,r,"step"))},checkNumberSliderStep:function(e){var e=parseFloat(e.target.value),i=w(this);!isNaN(e)&&0<e||w.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.error_number_slider_increment,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){i.val("").trigger("focus")}}}})},changeNumberSliderDefaultValue:function(e){var i,o,t,r=parseFloat(e.target.value);isNaN(r)||(i=parseFloat(e.target.max),o=parseFloat(e.target.min),t=w(e.target).parents(".wpforms-field-option-row-default_value").data("fieldId"),i<r?e.target.value=i:r<o?e.target.value=o:b.updateNumberSlider(t,r).updateNumberSliderHint(t,r))},updateNumberSliderDefaultValueAttr:function(e,i,o){var t,e=r.getElementById("wpforms-field-option-"+e+"-default_value");return e&&(t=parseFloat(e.value),e.setAttribute(o,i),i=parseFloat(i),"max"===o&&i<t&&(e.value=i,w(e).trigger("input")),"min"===o)&&t<i&&(e.value=i,w(e).trigger("input")),this},updateNumberSlider:function(e,i){e=r.getElementById("wpforms-number-slider-"+e);return e&&(e.value=i),this},updateNumberSliderAttr:function(e,i,o){e=r.getElementById("wpforms-number-slider-"+e);return e&&e.setAttribute(o,i),this},updateNumberSliderHintStr:function(e,i){e=r.getElementById("wpforms-number-slider-hint-"+e);return e&&(e.dataset.hint=i),this},updateNumberSliderHint:function(e,i){e=r.getElementById("wpforms-number-slider-hint-"+e);return e&&(e.innerHTML=wpf.sanitizeHTML(e.dataset.hint).replace("{value}","<b>"+i+"</b>")),this},fieldNumberSliderUpdateMin:function(e){var i=w(e.target).parents(".wpforms-field-option-row-min_max"),o=parseFloat(i.find(".wpforms-number-slider-max").val()),t=parseFloat(e.target.value);isNaN(t)||(o<=t?(e.preventDefault(),this.value=o):(e=i.data("field-id"),h.find("#wpforms-field-"+e+' input[type="range"]').attr("min",t)))},fieldNumberSliderUpdateMax:function(e){var i=w(e.target).parents(".wpforms-field-option-row-min_max"),o=parseFloat(i.find(".wpforms-number-slider-min").val()),t=parseFloat(e.target.value);isNaN(t)||(t<=o?(e.preventDefault(),this.value=o):(e=i.data("field-id"),h.find("#wpforms-field-"+e+' input[type="range"]').attr("max",t)))},updateNumberSliderStepValueMaxAttr:function(e,i){var o,e=r.getElementById("wpforms-field-option-"+e+"-step");return e&&(o=parseFloat(e.value),e.setAttribute("max",i),(i=parseFloat(i))<o)&&(e.value=i,w(e).trigger("input")),this},fieldFileUploadPreviewUpdate:function(e){var e=w(e).parents(".wpforms-field-option-file-upload"),i=e.data("field-id"),o=e.find("#wpforms-field-option-"+i+"-style").val(),e=e.find("#wpforms-field-option-row-"+i+"-max_file_number"),t=parseInt(e.find("input").val(),10),i=w("#wpforms-field-"+i),r=".wpforms-file-upload-builder-classic",n=".wpforms-file-upload-builder-modern";"classic"===o?(w(r,i).removeClass("wpforms-hide"),w(n,i).addClass("wpforms-hide"),e.addClass("wpforms-hidden")):(1<t?(i.find(".modern-title").text(wpforms_builder.file_upload.preview_title_plural),i.find(".modern-hint").text(wpforms_builder.file_upload.preview_hint.replace("{maxFileNumber}",t)).removeClass("wpforms-hide")):(i.find(".modern-title").text(wpforms_builder.file_upload.preview_title_single),i.find(".modern-hint").text(wpforms_builder.file_upload.preview_hint.replace("{maxFileNumber}",1)).addClass("wpforms-hide")),w(r,i).addClass("wpforms-hide"),w(n,i).removeClass("wpforms-hide"),e.removeClass("wpforms-hidden"))},updateTextFieldsLimitControls:function(e,i){i?w("#wpforms-field-option-row-"+e+"-limit_controls").removeClass("wpforms-hide"):w("#wpforms-field-option-row-"+e+"-limit_controls").addClass("wpforms-hide")},updatePasswordStrengthControls:function(e,i){e=w("#wpforms-field-option-row-"+e+"-password-strength-level");i?e.removeClass("wpforms-hidden"):e.addClass("wpforms-hidden")},updateRichTextMediaFieldsLimitControls:function(){var e=w(this),i=e.closest(".wpforms-field-option-row-media_enabled").data("field-id"),o=w("#wpforms-field-option-row-"+i+"-media_controls"),i=w("#wpforms-field-"+i+" .wpforms-richtext-wrap .mce-toolbar-grp");e.is(":checked")?(o.show(),i.addClass("wpforms-field-richtext-media-enabled")):(o.hide(),i.removeClass("wpforms-field-richtext-media-enabled"))},updateRichTextStylePreview:function(){var e=w(this),i=e.closest(".wpforms-field-option-row-style").data("field-id");w("#wpforms-field-"+i+" .wpforms-richtext-wrap .mce-toolbar-grp").toggleClass("wpforms-field-richtext-toolbar-basic","full"!==e.val())},bindUIActions:function(){b.bindUIActionsPanels(),b.bindUIActionsFields(),b.bindUIActionsSettings(),b.bindUIActionsRevisions(),b.bindUIActionsSaveExit(),b.bindUIActionsGeneral()},bindUIActionsPanels:function(){h.on("click","#wpforms-panels-toggle button, .wpforms-panel-switch",function(e){e.preventDefault(),b.panelSwitch(w(this).data("panel"))}),h.on("click",".wpforms-panel .wpforms-panel-sidebar-section",function(e){b.panelSectionSwitch(this,e)}),h.on("click",".wpforms-panels .wpforms-panel-sidebar-content .wpforms-panel-sidebar-toggle",function(){w(this).parent().toggleClass("wpforms-panel-sidebar-closed")})},panelSwitch:function(e){var i=w("#wpforms-panel-"+e),o=w(".wpforms-panel-"+e+"-button");if(!i.hasClass("active")){if(WPFormsUtils.triggerEvent(h,"wpformsPanelSwitch",[e]).isDefaultPrevented()||!wpforms_panel_switch)return!1;w("#wpforms-panels-toggle").find("button").removeClass("active"),w(".wpforms-panel").removeClass("active"),o.addClass("active"),i.addClass("active"),history.replaceState({},null,wpf.updateQueryString("view",e)),h.trigger("wpformsPanelSwitched",[e])}},panelSectionSwitch:function(e,i){i&&i.preventDefault();var i=w(e),e=i.parent().parent(),o=i.data("section"),t=e.find(".wpforms-panel-sidebar-section"),r=e.find(".wpforms-panel-sidebar-section-"+o);if(!i.hasClass("upgrade-modal")&&!i.hasClass("education-modal")&&!r.hasClass("active")){if(WPFormsUtils.triggerEvent(h,"wpformsPanelSectionSwitch",o).isDefaultPrevented()||!wpforms_panel_switch)return!1;t.removeClass("active"),r.addClass("active"),e.find(".wpforms-panel-content-section").hide(),e.find(".wpforms-panel-content-section-"+o).show()}},bindUIActionsSetup:function(){console.warn('WARNING! Function "WPFormsBuilder.bindUIActionsSetup()" has been deprecated, please use the new "WPForms.Admin.Builder.Setup.events()" function instead!'),WPForms.Admin.Builder.Setup.events()},templateSelect:function(e,i){console.warn('WARNING! Function "WPFormsBuilder.templateSelect()" has been deprecated, please use the new "WPForms.Admin.Builder.Setup.selectTemplate()" function instead!'),WPForms.Admin.Builder.Setup.selectTemplate(i)},bindUIActionsFields:function(){h.on("click",".wpforms-tab a",function(e){e.preventDefault(),b.fieldTabToggle(w(this).parent().attr("id"))}),h.on("click",".wpforms-add-fields-heading",function(e){e.preventDefault(),b.fieldGroupToggle(w(this),"click")}),h.on("click",".wpforms-field",function(e){b.isFieldPreviewActionsDisabled(this)||e.target.classList.contains("wpforms-dismiss-button")||(e.stopPropagation(),b.fieldTabToggle(w(this).data("field-id")))}),h.on("mousedown click",".wpforms-field input, .wpforms-field select, .wpforms-field textarea",function(e){e.preventDefault(),this.blur()}),h.on("click",".wpforms-field-delete",function(e){e.preventDefault(),e.stopPropagation(),b.isFormPreviewActionsDisabled(this)||b.fieldDelete(w(this).parent().data("field-id"))}),h.on("click",".wpforms-field-duplicate",function(e){e.preventDefault(),e.stopPropagation(),b.isFormPreviewActionsDisabled(this)||b.fieldDuplicate(w(this).parent().data("field-id"))}),h.on("click",".wpforms-add-fields-button",function(e){e.preventDefault();var i,e=w(this);e.hasClass("ui-draggable-disabled")||(i=e.data("field-type"),WPFormsUtils.triggerEvent(h,"wpformsBeforeFieldAddOnClick",[i,e]).isDefaultPrevented())||b.fieldAdd(i,{$sortable:"default"})}),h.on("wpformsFieldAdd",function(e,i,o){-1!==w.inArray(o,["select","radio","checkbox","payment-multiple","payment-checkbox","payment-select"])&&b.fieldChoiceSortable(o,`#wpforms-field-option-row-${i}-choices ul`)}),h.on("wpformsFieldOptionTabToggle",function(e,i){b.fieldLayoutSelectorInit(i)}),h.on("click",".wpforms-field-option-row-choices .add",function(e){b.fieldChoiceAdd(e,w(this))}),h.on("click",".wpforms-field-option-row-choices .remove",function(e){b.fieldChoiceDelete(e,w(this))}),h.on("mousedown",".wpforms-field-option-row-choices input[type=radio]",function(e){var i=w(this);i.is(":checked")?i.attr("data-checked","1"):i.attr("data-checked","0")}),h.on("click",".wpforms-field-option-row-choices input[type=radio]",function(e){var i=w(this),o=i.parent().parent();i.parent().parent().find("input[type=radio]").not(this).prop("checked",!1),"1"===i.attr("data-checked")&&(i.prop("checked",!1),i.attr("data-checked","0")),b.fieldChoiceUpdate(o.data("field-type"),o.data("field-id"))}),h.on("change",".wpforms-field-option-row-choices input[type=checkbox]",function(e){var i=w(this).parent().parent();b.fieldChoiceUpdate(i.data("field-type"),i.data("field-id"))}),h.on("change",".wpforms-field-option-row-show_values input",function(e){w(this).closest(".wpforms-field-option").find(".wpforms-field-option-row-choices ul").toggleClass("show-values")}),h.on("change",".wpforms-field-option-row-choices_images input",function(){var e=w(this),i=e.closest(".wpforms-field-option-row"),o=i.data("field-id"),t=w("#wpforms-field-option-"+o),e=e.is(":checked"),r=t.find(".wpforms-field-option-hidden-type").val(),n=i.siblings(".wpforms-field-option-row-choices_icons").find("input");e&&n.is(":checked")&&n.prop("checked",!1).trigger("change"),i.find(".wpforms-alert").toggleClass("wpforms-hidden"),t.find(".wpforms-field-option-row-choices ul").toggleClass("show-images"),t.find(".wpforms-field-option-row-choices_images_style").toggleClass("wpforms-hidden"),t.find(".wpforms-field-option-row-dynamic_choices").toggleClass("wpforms-hidden",e),(e?w("#wpforms-field-option-"+o+"-input_columns").val("inline"):w("#wpforms-field-option-"+o+"-input_columns").val("")).trigger("change"),b.fieldChoiceUpdate(r,o)}),h.on("wpformsImageUploadAdd wpformsImageUploadRemove",function(e,i,o){var o=o.closest(".choices-list"),t=o.data("field-id"),o=o.data("field-type");b.fieldChoiceUpdate(o,t)}),h.on("change",".wpforms-field-option-row-choices_images_style select",function(){var e=w(this).parent().data("field-id"),i=w("#wpforms-field-option-"+e).find(".wpforms-field-option-hidden-type").val();b.fieldChoiceUpdate(i,e)}),h.on("keyup",".wpforms-field-option-row-choices input.label, .wpforms-field-option-row-choices input.value",function(e){var i=w(this).parent().parent();b.fieldChoiceUpdate(i.data("field-type"),i.data("field-id"))}),h.on("click",".toggle-bulk-add-display",function(e){e.preventDefault(),b.fieldChoiceBulkAddToggle(this)}),h.on("click",".toggle-bulk-add-presets",function(e){e.preventDefault();e=w(this).closest(".bulk-add-display").find("ul");"block"===e.css("display")?w(this).text(wpforms_builder.bulk_add_presets_show):w(this).text(wpforms_builder.bulk_add_presets_hide),e.stop().slideToggle()}),h.on("click",".bulk-add-preset-insert",function(e){e.preventDefault();var e=w(this),i=e.data("preset"),e=e.closest(".bulk-add-display"),o=e.find("ul"),t=e.find(".toggle-bulk-add-presets"),e=e.find("textarea");e.val(""),e.insertAtCaret(wpforms_preset_choices[i].choices.join("\n")),t.text(wpforms_builder.bulk_add_presets_show),o.slideUp()}),h.on("click",".bulk-add-insert",function(e){e.preventDefault(),b.fieldChoiceBulkAddInsert(this)}),h.on("click",".wpforms-field-option-group-toggle:not(.education-modal)",function(e){if(WPFormsUtils.triggerEvent(h,"wpformsFieldOptionGroupToggle").isDefaultPrevented())return!1;e.preventDefault();e=w(this).closest(".wpforms-field-option-group");e.siblings(".wpforms-field-option-group").removeClass("active"),e.addClass("active")}),h.on("change",".wpforms-field-option-address input.wpforms-subfield-hide",function(e){var i=w(this).closest(".wpforms-field-option-row"),o=i.data("field-id"),i=i.data("subfield");w("#wpforms-field-"+o).find(".wpforms-"+i).toggleClass("wpforms-hide")}),h.on("input",".wpforms-field-option-row-label input, .wpforms-field-option-row-name input",function(e){var i=w(this),o=i.parent().data("field-id"),o=w("#wpforms-field-"+o),t=o.data("field-type");let r=i.val(),n=0===r.length;(n="html"===t?!1:n)&&(r=wpforms_builder.empty_label),o.toggleClass("label_empty",n).find("> .label-title .text").text(r)}),h.on("input",".wpforms-field-option-row-description textarea",function(){var e=w(this),i=wpf.sanitizeHTML(e.val()),o=e.parent().data("field-id"),t=w("#wpforms-field-"+o).find(".description");b.updateDescription(t,i),e.trigger("wpformsDescriptionFieldUpdated",{id:o,descField:t,value:i})}),h.on("change",".wpforms-field-option-row-required input",function(e){var i=w(this).closest(".wpforms-field-option-row").data("field-id");w("#wpforms-field-"+i).toggleClass("required")}),h.on("change",".wpforms-field-option-row-confirmation input",function(e){var i=w(this).closest(".wpforms-field-option-row").data("field-id");w("#wpforms-field-"+i).find(".wpforms-confirm").toggleClass("wpforms-confirm-enabled wpforms-confirm-disabled"),w("#wpforms-field-option-"+i).toggleClass("wpforms-confirm-enabled wpforms-confirm-disabled")}),h.on("change",".wpforms-field-option-row-filter_type select",function(){var e=w(this).parent().data("field-id"),e=w("#wpforms-field-option-"+e);w(this).val()?(e.removeClass("wpforms-filter-allowlist"),e.removeClass("wpforms-filter-denylist"),e.addClass("wpforms-filter-"+w(this).val())):(e.removeClass("wpforms-filter-allowlist"),e.removeClass("wpforms-filter-denylist"))}),h.on("focusout",".wpforms-field-option-row-allowlist textarea,.wpforms-field-option-row-denylist textarea",function(){var e=w(".wpforms-field-option-row-allowlist textarea"),i=w(".wpforms-field-option-row-denylist textarea"),o=w(this),t="allow";""!==o.val()&&(o.is(i)&&(t="deny"),w.get(wpforms_builder.ajax_url,{nonce:wpforms_builder.nonce,content:JSON.stringify({allow:e.val(),deny:i.val(),current:t}),action:"wpforms_sanitize_restricted_rules"},function(e){e.success&&(o.val(e.data.currentField),0!==(e=e.data.intersect).length)&&(e="<p>"+wpforms_builder.allow_deny_lists_intersect+'</p><p class="bold">'+e+"</p>",w.alert({title:wpforms_builder.heads_up,content:e,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}))}))}),h.on("click",function(){b.focusOutEvent()}),h.on("focusout",g.defaultEmailSelector,function(){g.$focusOutTarget=w(this)}),h.on("change",".wpforms-field-option-row-size select",function(e){var i=w(this),o=i.val(),i=i.parent().data("field-id");w("#wpforms-field-"+i).removeClass("size-small size-medium size-large").addClass("size-"+o)}),h.on("input",".wpforms-field-option-row-placeholder input",function(){var e=w(this),i=wpf.sanitizeHTML(e.val()),e=e.parent().data("field-id"),o=w("#wpforms-field-"+e),t=o.find(".primary-input");"payment-single"===o.data("field-type")&&""===i&&(i=w("#wpforms-field-option-"+e+"-price").prop("placeholder")),t.is("select")?b.dropdownField.helpers.isModernSelect(t)?(o=b.dropdownField.helpers.getInstance(t),t.prop("multiple")?w(o.input.element).prop("placeholder",i):(o.setChoiceByValue(""),t.closest(".choices").find(".choices__inner .choices__placeholder").text(i),o=w("#wpforms-field-option-"+e+"-dynamic_choices").val(),b.dropdownField.helpers.update(e,o))):(e=t.find(".placeholder"),!i.length&&e.length?e.remove():(e.length?e.text(i):t.prepend('<option value="" class="placeholder">'+i+"</option>"),t.find(".placeholder").prop("selected",!t.prop("multiple")))):t.prop("placeholder",i)}),h.on("input",".wpforms-field-option-row-default_value input",function(){var e=w(this),i=wpf.sanitizeHTML(e.val()),e=e.closest(".wpforms-field-option-row").data("field-id");w(`#wpforms-field-${e} .primary-input`).val(i)}),h.on("input",".wpforms-field-options-column input.default",function(){var e=w(this),i=wpf.sanitizeHTML(e.val()),e=e.closest(".wpforms-field-option-row"),o=e.data("field-id"),e=e.data("subfield");w(`#wpforms-field-${o} .wpforms-${e} input`).val(i)}),h.on("input",".wpforms-field-option-row-confirmation_placeholder input",function(e){var i=w(this),o=i.val(),i=i.parent().data("field-id");w("#wpforms-field-"+i).find(".secondary-input").attr("placeholder",o)}),h.on("change",".wpforms-field-option-row-label_hide input",function(e){var i=w(this).closest(".wpforms-field-option-row").data("field-id");w("#wpforms-field-"+i).toggleClass("label_hide")}),h.on("change",".wpforms-field-option-row-sublabel_hide input",function(e){var i=w(this).closest(".wpforms-field-option-row").data("field-id");w("#wpforms-field-"+i).toggleClass("sublabel_hide")}),h.on("change",".wpforms-field-option-row-format select",function(){var e=w(this),i=e.val(),e=e.parent().data("field-id"),o=w("#wpforms-field-option-row-"+e+"-sublabel_hide");w("#wpforms-field-"+e).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i),w("#wpforms-field-option-"+e).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i),["date-time","first-last","first-middle-last"].includes(i)?o.removeClass("wpforms-hidden"):o.addClass("wpforms-hidden"),["single","user","hidden"].includes(i)&&(o=w("#wpforms-field-option-row-"+e+"-placeholder"),"user"===i?o.removeClass("wpforms-hidden"):o.addClass("wpforms-hidden"))}),h.on("change",".wpforms-field-option-row-scheme select",function(e){var i=w(this),o=i.val(),i=i.parent().data("field-id"),t=w("#wpforms-field-"+i);t.find(".wpforms-address-scheme").addClass("wpforms-hide"),t.find(".wpforms-address-scheme-"+o).removeClass("wpforms-hide"),0==t.find(".wpforms-address-scheme-"+o+" .wpforms-country").children().length?w("#wpforms-field-option-"+i).find(".wpforms-field-option-row-country").addClass("wpforms-hidden"):w("#wpforms-field-option-"+i).find(".wpforms-field-option-row-country").removeClass("wpforms-hidden")}),h.on("input",".wpforms-field-option .format-selected input.placeholder, .wpforms-field-option-address input.placeholder",function(e){var i=w(this),o=i.val(),i=i.closest(".wpforms-field-option-row"),t=i.data("field-id"),i=i.data("subfield");w("#wpforms-field-"+t).find(".wpforms-"+i+" input").attr("placeholder",o)}),h.on("change",".wpforms-field-option-row-date .type select",function(e){var i=w(this),o=i.val(),t=w(this).closest(".wpforms-field-option-row").data("field-id"),r="datepicker"===o?"wpforms-date-type-datepicker":"wpforms-date-type-dropdown",n="datepicker"===o?"wpforms-date-type-dropdown":"wpforms-date-type-datepicker",r=(w("#wpforms-field-"+t).find(".wpforms-date").addClass(r).removeClass(n),w("#wpforms-field-option-"+t).addClass(r).removeClass(n),i.closest(".wpforms-field-option-group-advanced").find(".wpforms-field-option-row-date_limit_days, .wpforms-field-option-row-date_limit_days_options, .wpforms-field-option-row-date_disable_past_dates")),n=w("#wpforms-field-option-row-"+t+"-date_limit_days_options");"dropdown"===o?((i=w("#wpforms-field-option-"+t+"-date_format")).find("option:selected").hasClass("datepicker-only")&&i.prop("selectedIndex",0).trigger("change"),r.hide()):(r.show(),w("#wpforms-field-option-"+t+"-date_limit_days").is(":checked")?n.show():n.hide())}),h.on("change",".wpforms-field-option-row-date .format select",function(e){var i=w(this).val(),o=w(this).closest(".wpforms-field-option-row").data("field-id"),o=w("#wpforms-field-"+o);"m/d/Y"===i?(o.find(".wpforms-date-dropdown .first option").text(wpforms_builder.date_select_month),o.find(".wpforms-date-dropdown .second option").text(wpforms_builder.date_select_day)):"d/m/Y"===i&&(o.find(".wpforms-date-dropdown .first option").text(wpforms_builder.date_select_day),o.find(".wpforms-date-dropdown .second option").text(wpforms_builder.date_select_month))}),h.on("change",".wpforms-field-option-row-time .format select",function(e){const i=w(this),r=i.closest(".wpforms-field-option-row").data("field-id");let n="",o;const s=i.val().match(/[gh]/)?12:24,t=12==s?1:0,a=12==s?13:24;for(let e=t;e<a;e++)o=e<10?"0"+e:e,n+='<option value="{hh}">{hh}</option>'.replace(/{hh}/g,o);_.forEach(["start","end"],function(e){var i=h.find("#wpforms-field-option-"+r+"-time_limit_hours_"+e+"_hour"),e=h.find("#wpforms-field-option-"+r+"-time_limit_hours_"+e+"_ampm");let o=parseInt(i.val(),10),t=e.val();o=(o=24==s?"pm"===t?o+12:o:(t=12<o?"pm":"am",12<o?o-12:o))<10?"0"+o:o,i.html(n).val(o),e.toggleClass("wpforms-hidden-strict",24==s).val(t),e.nextAll("div").toggleClass("wpforms-hidden-strict",12==s)})}),h.on("click",".wpforms-pagebreak-button",function(e){e.preventDefault(),w(this).closest(".wpforms-field").trigger("click")}),b.fieldPageBreakInitDisplayPrevious(h.find(".wpforms-field-pagebreak.wpforms-pagebreak-normal").first()),h.on("input",".wpforms-field-option-row-next input",function(e){var i=w(this),o=i.val(),i=w("#wpforms-field-"+i.parent().data("field-id")).find(".wpforms-pagebreak-next");o?i.css("display","inline-block").text(o):i.css("display","none").empty()}).on("input",".wpforms-field-option-row-prev input",function(e){var i=w(this),o=i.val().trim(),i=w("#wpforms-field-"+i.parent().data("field-id")),t=i.find(".wpforms-pagebreak-prev");o&&0<i.prevAll(".wpforms-field-pagebreak.wpforms-pagebreak-normal").length?t.removeClass("wpforms-hidden").text(o):t.addClass("wpforms-hidden").empty()}).on("change",".wpforms-field-option-row-prev_toggle input",function(e){var i=w(this),o=i.closest(".wpforms-field-option-row-prev_toggle"),t=i.closest(".wpforms-field-option-group-inner").find(".wpforms-field-option-row-prev"),r=t.find("input"),n=w("#wpforms-field-"+i.closest(".wpforms-field-option").data("field-id")).find(".wpforms-pagebreak-prev");o.hasClass("wpforms-entry-preview-block")||(t.toggleClass("wpforms-hidden",!i.prop("checked")),n.toggleClass("wpforms-hidden",!i.prop("checked")),i.prop("checked")&&!r.val()&&(o=(o=r.data("last-value"))&&o.trim()?o.trim():wpforms_builder.previous,r.val(o)),i.prop("checked")||(r.data("last-value",r.val()),r.val("")),r.trigger("input"))}).on("wpformsFieldAdd",b.fieldPagebreakAdd).on("wpformsFieldDelete",b.fieldPagebreakDelete).on("wpformsBeforeFieldDelete",b.fieldEntryPreviewDelete),h.on("wpformsFieldMove wpformsFieldAdd wpformsFieldDelete",function(e){h.find(".wpforms-field-pagebreak.wpforms-pagebreak-normal").each(function(e){b.fieldPageBreakInitDisplayPrevious(w(this))})}),h.on("input",".wpforms-field-option-row-title input",function(e){var i=w(this),o=i.val(),i=i.parent().data("field-id");o?w("#wpforms-field-"+i).find(".wpforms-pagebreak-title").text(o):w("#wpforms-field-"+i).find(".wpforms-pagebreak-title").empty()}),h.on("change",".wpforms-field-option-row-nav_align select",function(e){var i=(i=w(this).val())||"center";w(".wpforms-pagebreak-buttons").removeClass("wpforms-pagebreak-buttons-center wpforms-pagebreak-buttons-left wpforms-pagebreak-buttons-right wpforms-pagebreak-buttons-split").addClass("wpforms-pagebreak-buttons-"+i)}),h.on("input",".wpforms-field-option-row-price input",function(e){var i=w(this),o=i.val(),i=i.parent().data("field-id"),t=wpf.amountSanitize(o),t=wpf.amountFormat(t),r="right"===wpforms_builder.currency_symbol_pos?t+" "+wpforms_builder.currency_symbol:wpforms_builder.currency_symbol+" "+t,n=w("#wpforms-field-option-"+i+"-placeholder").val().trim(),i=w("#wpforms-field-"+i),o=""===o&&""!==n?"":t;i.find(".primary-input").val(o),i.find(".price").text(r)}),h.on("change",".wpforms-field-option-credit-card .payment-icons input",function(e){var i=w(this),o=i.data("card"),i=i.parent().data("field-id");w("#wpforms-field-"+i).find("img.icon-"+o).toggleClass("card_hide")}),h.on("input",".wpforms-field-option input.placeholder-update",function(e){var i=w(this),o=i.val(),t=i.data("field-id"),i=i.data("subfield");w("#wpforms-field-"+t).find(".wpforms-"+i+" input").attr("placeholder",o)}),h.on("change",".wpforms-field-option-row-input_columns select",function(){var e=w(this),i=e.val(),o="",e=e.parent().data("field-id");"2"===i?o="wpforms-list-2-columns":"3"===i?o="wpforms-list-3-columns":"inline"===i&&(o="wpforms-list-inline"),w("#wpforms-field-"+e).removeClass("wpforms-list-2-columns wpforms-list-3-columns wpforms-list-inline").addClass(o)}),h.on("change",".wpforms-field-option-row .wpforms-toggle-control input",function(e){var i=w(this),o=i.closest(".wpforms-toggle-control").find(".wpforms-toggle-control-status"),i=i.is(":checked")?"on":"off";o.html(o.data(i))}),h.on("change",".wpforms-field-option-row-dynamic_choices select",function(e){b.fieldDynamicChoiceToggle(w(this))}),h.on("change",".wpforms-field-option-row-dynamic_taxonomy select, .wpforms-field-option-row-dynamic_post_type select",function(e){b.fieldDynamicChoiceSource(w(this))}),h.on("click",".toggle-layout-selector-display",function(e){e.preventDefault(),b.fieldLayoutSelectorToggle(this)}),h.on("click",".layout-selector-display-layout",function(e){e.preventDefault(),b.fieldLayoutSelectorLayout(this)}),h.on("click",".layout-selector-display-columns span",function(e){e.preventDefault(),b.fieldLayoutSelectorInsert(this)}),w(r).on("change",".wpforms-field-option-row-scale select",function(){var e=w(this),i=e.val(),e=e.parent().data("field-id"),e=w("#wpforms-field-"+e+" .rating-icon"),o=1;e.each(function(e){o<=i?w(this).show():w(this).hide(),o++})}),w(r).on("change",".wpforms-field-option-row-icon select",function(){var e=w(this),i=e.val(),e=e.parent().data("field-id"),o="fa-star";"heart"===i?o="fa-heart":"thumb"===i?o="fa-thumbs-up":"smiley"===i&&(o="fa-smile-o"),w("#wpforms-field-"+e+" .rating-icon").removeClass("fa-star fa-heart fa-thumbs-up fa-smile-o").addClass(o)}),w(r).on("change",".wpforms-field-option-row-icon_size select",function(){var e=w(this),i=e.val(),e=e.parent().data("field-id"),e=w("#wpforms-field-"+e+" .rating-icon");fontSize="28","small"===i?fontSize="18":"large"===i&&(fontSize="38"),e.css("font-size",fontSize+"px")}),w(r).on("input",".wpforms-field-option-row-icon_color input.wpforms-color-picker",function(){var e=w(this),i=e.closest(".wpforms-field-option-row").data("field-id");w("#wpforms-field-"+i+" > i.fa").css("color",b.getValidColorPickerValue(e))}),w(r).on("change",".wpforms-field-option-row-disclaimer_format input",function(){var e=w(this).closest(".wpforms-field-option-row").data("field-id");w("#wpforms-field-"+e+" .description").toggleClass("disclaimer")}),h.on("change",".wpforms-field-option-row-limit_enabled input",function(e){b.updateTextFieldsLimitControls(w(e.target).closest(".wpforms-field-option-row-limit_enabled").data().fieldId,e.target.checked)}),h.on("change",".wpforms-field-option-row-password-strength input",function(e){b.updatePasswordStrengthControls(w(e.target).parents(".wpforms-field-option-row-password-strength").data().fieldId,e.target.checked)}),h.on("change",".wpforms-field-option-richtext .wpforms-field-option-row-media_enabled input",b.updateRichTextMediaFieldsLimitControls),h.on("change",".wpforms-field-option-richtext .wpforms-field-option-row-style select",b.updateRichTextStylePreview),h.on("change",".wpforms-field-option-file-upload .wpforms-field-option-row-style select, .wpforms-field-option-file-upload .wpforms-field-option-row-max_file_number input",function(e){b.fieldFileUploadPreviewUpdate(e.target)}),b.numberSliderEvents(h),b.fieldDynamicChoiceToggleImageChoices(),b.fieldDynamicChoiceToggleIconChoices(),h.on("change",".wpforms-field-option-row-show_price_after_labels input",function(e){var i=w(this).closest(".wpforms-field-option-group-basic").find(".wpforms-field-option-row-choices .choices-list");b.fieldChoiceUpdate(i.data("field-type"),i.data("field-id"))}),h.on("input",".wpforms-field-option-row-preview-notice textarea",b.updatePreviewNotice).on("change",".wpforms-field-option-row-preview-notice-enable input",b.toggleEntryPreviewNotice).on("wpformsFieldAdd",b.maybeLockEntryPreviewGroupOnAdd).on("wpformsFieldMove",b.maybeLockEntryPreviewGroupOnMove).on("click",".wpforms-entry-preview-block",b.entryPreviewBlockField),b.defaultStateEntryPreviewNotice()},focusOutEvent:function(){if(null!==g.$focusOutTarget){if(g.$defaultEmail.is(g.$focusOutTarget)){var i=g.$focusOutTarget;if(""===i.val())return;w.get(wpforms_builder.ajax_url,{nonce:wpforms_builder.nonce,content:i.val(),action:"wpforms_sanitize_default_email"},function(e){e.success&&(i.val(e.data),i.trigger("input"))})}g.$focusOutTarget=null}},isFieldPreviewActionsDisabled:function(e){return b.isFormPreviewActionsDisabled(e)||w(e).closest(".wpforms-field").hasClass("ui-sortable-disabled")},isFormPreviewActionsDisabled:function(e){return w(e).closest(".wpforms-field-wrap").hasClass("ui-sortable-disabled")},fieldGroupToggle:function(e,i){var e=w(e),o=e.next(".wpforms-add-fields-buttons"),t=o.parent(),r=e.find("i"),n="wpforms_field_group_"+e.data("group");"click"===i?(t.hasClass("wpforms-closed")?wpCookies.remove(n):wpCookies.set(n,"true",2592e3),r.toggleClass("wpforms-angle-right"),o.stop().slideToggle("",function(){t.toggleClass("wpforms-closed")})):"load"===i&&(o=e.find(".wpforms-add-fields-buttons"),r=e.find(".wpforms-add-fields-heading i"),n=e.find(".wpforms-add-fields-heading").data("group"),"true"===wpCookies.get("wpforms_field_group_"+n))&&(r.toggleClass("wpforms-angle-right"),o.hide(),e.toggleClass("wpforms-closed"))},updateDescription:function(e,i){e.hasClass("nl2br")&&(i=i.replace(/\n/g,"<br>")),e.html(i)},defaultStateEntryPreviewNotice:function(){w(".wpforms-field-option-row-preview-notice-enable input").each(function(){w(this).trigger("change")})},updatePreviewNotice:function(){var e=w(this),i=wpf.sanitizeHTML(e.val()).trim(),e=e.parent().data("field-id"),e=w("#wpforms-field-"+e).find(".wpforms-entry-preview-notice"),i=i||wpforms_builder.entry_preview_default_notice;b.updateDescription(e,i)},toggleEntryPreviewNotice:function(){var e=w(this),i=e.closest(".wpforms-field-option").data("field-id"),o=w("#wpforms-field-"+i),i=w("#wpforms-field-option-"+i+" .wpforms-field-option-row-preview-notice"),t=o.find(".wpforms-entry-preview-notice"),o=o.find(".wpforms-alert-info");(e.is(":checked")?(o.hide(),t.show(),i):(i.hide(),t.hide(),o)).show()},fieldDelete:function(e){var i=w("#wpforms-field-"+e),o=i.data("field-type");"pagebreak"===o&&i.hasClass("wpforms-field-entry-preview-not-deleted")?b.youCantRemovePageBreakFieldPopup():i.hasClass("no-delete")?b.youCantRemoveFieldPopup():b.confirmFieldDeletion(e,o)},youCantRemovePageBreakFieldPopup:function(){w.alert({title:wpforms_builder.heads_up,content:wpforms_builder.entry_preview_require_page_break,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},youCantReorderFieldPopup:function(){console.warn('WARNING! Function "WPFormsBuilder.youCantReorderFieldPopup()" has been deprecated, please use the new "WPForms.Admin.Builder.DragFields.youCantReorderFieldPopup()" function instead!'),WPForms.Admin.Builder.DragFields.youCantReorderFieldPopup()},youCantRemoveFieldPopup:function(){w.alert({title:wpforms_builder.field_locked,content:wpforms_builder.field_locked_no_delete_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}}})},confirmFieldDeletion:function(e,i){var o={id:e,message:wpforms_builder.delete_confirm};WPFormsUtils.triggerEvent(h,"wpformsBeforeFieldDeleteAlert",[o,i]).isDefaultPrevented()||w.confirm({title:!1,content:o.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){b.fieldDeleteById(e)}},cancel:{text:wpforms_builder.cancel}}})},fieldDeleteById:function(t,e=0,i=400){w("#wpforms-field-"+t).fadeOut(i,function(){var e=w(this),i=e.data("field-type"),e=(h.trigger("wpformsBeforeFieldDelete",[t,i]),e.remove(),w("#wpforms-field-option-"+t).remove(),w(".wpforms-field, .wpforms-title-desc").removeClass("active"),b.fieldTabToggle("add-fields"),w(".wpforms-field-option")),o=h.find(".wpforms-field-submit");e.length<1&&(g.$sortableFieldsWrap.append(g.$noFieldsPreview.clone()),g.$fieldOptions.append(g.$noFieldsOptions.clone()),o.hide()),e.filter(":not(.wpforms-field-option-layout)").length||o.hide(),h.trigger("wpformsFieldDelete",[t,i])})},loadEntryPreviewFields:function(){var e=w("#wpforms-panel-fields .wpforms-field-wrap .wpforms-field-entry-preview");e.length&&e.each(function(){b.lockEntryPreviewFieldsPosition(w(this).data("field-id"))})},fieldEntryPreviewDelete:function(e,i,o){"entry-preview"===o&&(i=(o=w("#wpforms-field-"+i)).prevAll(".wpforms-field-pagebreak").first(),o=o.nextAll(".wpforms-field-pagebreak").first().data("field-id"),o=w("#wpforms-field-option-"+o),i.removeClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),o.find(".wpforms-entry-preview-block").removeClass("wpforms-entry-preview-block"),h.trigger("wpformsFieldDragToggle",[i.data("field-id"),i.data("field-type")]))},maybeLockEntryPreviewGroupOnMove:function(e,i){i.item.hasClass("wpforms-field-pagebreak")&&b.maybeLockEntryPreviewGroupOnAdd(e,i.item.data("field-id"),"pagebreak")},maybeLockEntryPreviewGroupOnAdd:function(e,i,o){var t,r,n,s,a,l,d,f,p;"pagebreak"===o&&(t=w("#wpforms-field-"+i),n=(r=w("#wpforms-field-option-"+i+" .wpforms-field-option-row-prev_toggle")).find("input"),a=(s=t.prevAll(".wpforms-field-entry-preview,.wpforms-field-pagebreak").first()).data("field-id"),d=(l=w("#wpforms-field-option-"+a+" .wpforms-field-option-row-prev_toggle")).find("input"),f=t.nextAll(".wpforms-field-entry-preview,.wpforms-field-pagebreak").first(),p=w("#wpforms-field-option-"+f.data("field-id")+" .wpforms-field-option-row-prev_toggle"),s.hasClass("wpforms-field-entry-preview")||f.hasClass("wpforms-field-entry-preview"))&&(s.hasClass("wpforms-field-entry-preview")?(n.attr("checked","checked").trigger("change"),r.addClass("wpforms-entry-preview-block"),p.removeClass("wpforms-entry-preview-block")):(t.addClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),h.trigger("wpformsFieldDragToggle",[i,o]),s.removeClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),h.trigger("wpformsFieldDragToggle",[a,s.data("field-type")]),s.prevAll(".wpforms-field-entry-preview,.wpforms-field-pagebreak").first().hasClass("wpforms-field-entry-preview")&&(d.attr("checked","checked").trigger("change"),l.addClass("wpforms-entry-preview-block"))))},entryPreviewBlockField:function(e){e.preventDefault(),w.alert({title:wpforms_builder.heads_up,content:wpforms_builder.entry_preview_require_previous_button,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},isUncheckedEntryPreviewField:function(e,i){return!("entry-preview"!==e||i&&i.passed)},addEntryPreviewField:function(e,i){var o,t,r,n=w("#wpforms-add-fields-entry-preview");n.hasClass("wpforms-entry-preview-adding")||(r=w("#wpforms-panel-fields .wpforms-field-wrap > .wpforms-field"),o=i&&i.position?i.position:r.length,t=b.isEntryPreviewFieldRequiresPageBreakBefore(r,o),r=b.isEntryPreviewFieldRequiresPageBreakAfter(r,o),n.addClass("wpforms-entry-preview-adding"),(i=i||{}).passed=!0,t||r?t?b.addPageBreakAndEntryPreviewFields(i,o):b.addEntryPreviewAndPageBreakFields(i,o):b.fieldAdd("entry-preview",i).done(function(e){b.lockEntryPreviewFieldsPosition(e.data.field.id)}))},addEntryPreviewFieldAfterPageBreak:function(e){var i=setInterval(function(){2===w("#wpforms-panel-fields .wpforms-field-wrap").find(".wpforms-pagebreak-bottom, .wpforms-pagebreak-top").length&&(b.fieldAdd("entry-preview",e).done(function(e){b.lockEntryPreviewFieldsPosition(e.data.field.id)}),clearInterval(i))},100)},addPageBreakAndEntryPreviewFields:function(i,o){var t=3<=w("#wpforms-panel-fields .wpforms-field-wrap > .wpforms-field-pagebreak").length;b.fieldAdd("pagebreak",{position:o}).done(function(e){i.position=t?o+1:o+2,b.addEntryPreviewFieldAfterPageBreak(i);e=w("#wpforms-field-option-"+e.data.field.id).find(".wpforms-field-option-row-prev_toggle");e.find("input").attr("checked","checked").trigger("change"),e.addClass("wpforms-entry-preview-block")})},fieldDuplicate:function(o){const t=w("#wpforms-field-"+o);t.hasClass("no-duplicate")?w.alert({title:wpforms_builder.field_locked,content:wpforms_builder.field_locked_no_duplicate_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}}}):w.confirm({title:!1,content:wpforms_builder.duplicate_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e,i;this.$$confirm.prop("disabled",!0),WPFormsUtils.triggerEvent(h,"wpformsBeforeFieldDuplicate",[o,t]).isDefaultPrevented()||(e=b.fieldDuplicateRoutine(o),i=w("#wpforms-field-"+e),b.increaseNextFieldIdAjaxRequest(),WPFormsUtils.triggerEvent(h,"wpformsFieldDuplicated",[o,t,e,i]))}},cancel:{text:wpforms_builder.cancel}}})},increaseNextFieldIdAjaxRequest:function(){w.post(wpforms_builder.ajax_url,{form_id:m.formID,field_id:g.$nextFieldId.val(),nonce:wpforms_builder.nonce,action:"wpforms_builder_increase_next_field_id"})},fieldDuplicateRoutine:function(e){var i=w("#wpforms-field-"+e),o=w("#wpforms-field-option-"+e),t=i.data("field-type"),r=o.attr("class"),n=b.dropdownField.helpers.isModernSelect(i.find("> .choices .primary-input"));wpf.restoreTooltips(o),n&&b.dropdownField.helpers.convertModernToClassic(e);let s=o.html();const a=i.clone(),l=parseInt(g.$nextFieldId.val(),10),d=w(`#wpforms-field-option-${e}-label`),f=(d.length?d:w(`#wpforms-field-option-${e}-name`)).val(),p=l+1,c={};var m=""!==f?f+" "+wpforms_builder.duplicate_copy:wpforms_builder.field+` #${e} `+wpforms_builder.duplicate_copy;c.fieldOptionsID=new RegExp("ID #"+e,"g"),c.fieldID=new RegExp("fields\\["+e+"\\]","g"),c.dataFieldID=new RegExp('data-field-id="'+e+'"',"g"),c.referenceID=new RegExp('data-reference="'+e+'"',"g"),c.elementID=new RegExp('\\b(id|for)="wpforms-(.*?)'+e+'(.*?)"',"ig"),i.after(a),i.removeClass("active"),a.addClass("active").attr({id:"wpforms-field-"+l,"data-field-id":l}),c.elementIdReplace=function(e,i,o,t,r,n){return`${i}="wpforms-${o}${l}${t}"`},s=(s=(s=(s=(s=s.replace(c.fieldOptionsID,"ID #"+l)).replace(c.fieldID,`fields[${l}]`)).replace(c.dataFieldID,`data-field-id="${l}"`)).replace(c.referenceID,`data-reference="${l}"`)).replace(c.elementID,c.elementIdReplace),o.hide().after(`<div class="${r}" id="wpforms-field-option-${l}" data-field-id="${l}">${s}</div>`);const u=w("#wpforms-field-option-"+l);return o.find(":input").each(function(e,i){var o=w(this),t=o.attr("name");if(!t)return"continue";var t=t.replace(c.fieldID,`fields[${l}]`),r=o.attr("type");"checkbox"===r||"radio"===r?o.is(":checked")?u.find(`[name="${t}"]`).prop("checked",!0).attr("checked","checked"):u.find(`[name="${t}"]`).prop("checked",!1).attr("checked",!1):o.is("select")?o.find("option:selected").length&&(r=o.find("option:selected").val(),u.find(`[name="${t}"]`).find(`[value="${r}"]`).prop("selected",!0)):(""!==(r=o.val())&&u.find(`[name="${t}"]`).val(r),""===r&&o.hasClass("wpforms-money-input")&&u.find(`[name="${t}"]`).val(wpf.numberFormat("0",wpforms_builder.currency_decimals,wpforms_builder.currency_decimal,wpforms_builder.currency_thousands)))}),u.find(".wpforms-field-option-hidden-id").val(l),g.$nextFieldId.val(p),w("html"===t?`#wpforms-field-option-${l}-name`:`#wpforms-field-option-${l}-label`).val(m).trigger("input"),h.trigger("wpformsFieldAdd",[l,t]),wpf.initTooltips(),n&&(b.dropdownField.helpers.convertClassicToModern(e),b.dropdownField.helpers.convertClassicToModern(l)),b.fieldChoiceUpdate(a.data("field-type"),l),b.loadColorPickers(),l},addEntryPreviewAndPageBreakFields:function(e,o){b.fieldAdd("entry-preview",e).done(function(e){var i=e.data.field.id;b.fieldAdd("pagebreak",{position:o+1}).done(function(e){b.lockEntryPreviewFieldsPosition(i);e=w("#wpforms-field-"+e.data.field.id).nextAll(".wpforms-field-pagebreak, .wpforms-field-entry-preview").first();e.hasClass("wpforms-field-entry-preview")&&b.lockEntryPreviewFieldsPosition(e.data("field-id"))})})},lockEntryPreviewFieldsPosition:function(e){var i=w("#wpforms-field-"+e),o=i.prevAll(".wpforms-field-pagebreak:not(.wpforms-pagebreak-bottom)").first(),t=i.nextAll(".wpforms-field-pagebreak").first().data("field-id"),t=w("#wpforms-field-option-"+t).find(".wpforms-field-option-row-prev_toggle"),r=t.find("input");i.addClass("wpforms-field-not-draggable"),o.addClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),r.attr("checked","checked").trigger("change"),t.addClass("wpforms-entry-preview-block"),w("#wpforms-add-fields-entry-preview").removeClass("wpforms-entry-preview-adding"),h.trigger("wpformsFieldDragToggle",[e,i.data("field-type")]),h.trigger("wpformsFieldDragToggle",[o.data("field-id"),o.data("field-type")])},isEntryPreviewFieldRequiresPageBreakBefore:function(e,i){var e=e.slice(0,i).filter(".wpforms-field-pagebreak,.wpforms-field-entry-preview"),o=!0;return e.length&&w(e.get().reverse()).each(function(){var e=w(this);return!e.hasClass("wpforms-field-entry-preview")&&(e.hasClass("wpforms-field-pagebreak")&&!e.hasClass("wpforms-field-stick")?o=!1:void 0)}),o},isEntryPreviewFieldRequiresPageBreakAfter:function(e,i){var e=e.slice(i).filter(".wpforms-field-pagebreak,.wpforms-field-entry-preview"),o=Boolean(e.length);return e.length&&e.each(function(){var e=w(this);return!e.hasClass("wpforms-field-entry-preview")&&(e.hasClass("wpforms-field-pagebreak")?o=!1:void 0)}),o},fieldAdd:function(n,s){var e=w("#wpforms-add-fields-"+n);if(!(e.hasClass("upgrade-modal")||e.hasClass("education-modal")||e.hasClass("warning-modal")))if(["captcha_hcaptcha","captcha_recaptcha","captcha_none"].includes(n))b.captchaUpdate();else{if(l=!0,WPForms.Admin.Builder.DragFields.disableDragAndDrop(),b.disableFormActions(),!b.isUncheckedEntryPreviewField(n,s))return s=w.extend({},{position:"bottom",$sortable:"base",placeholder:!1,scroll:!0,defaults:!1},s),e={action:"wpforms_new_field_"+n,id:m.formID,type:n,defaults:s.defaults,nonce:wpforms_builder.nonce},w.post(wpforms_builder.ajax_url,e,function(i){if(i.success){var o=g.$sortableFieldsWrap,t=w(i.data.preview),r=w(i.data.options);let e=s.$sortable;l=!1,t.css("display","none"),s.placeholder&&s.placeholder.remove(),"default"!==s.$sortable&&s.$sortable.length||(e=o.find(".wpforms-fields-sortable-default")),"base"!==s.$sortable&&e.length||(e=o);o=WPFormsUtils.triggerEvent(h,"wpformsBeforeFieldAddToDOM",[s,t,r,e]);o.isDefaultPrevented()||(o.skipAddFieldToBaseLevel||b.fieldAddToBaseLevel(s,t,r),t.fadeIn(),h.find(".no-fields, .no-fields-preview").remove(),w(".wpforms-field-option:not(.wpforms-field-option-layout)").length&&h.find(".wpforms-field-submit").show(),s.scroll&&s.position.length&&b.scrollPreviewToField(i.data.field.id),g.$nextFieldId.val(i.data.field.id+1),wpf.initTooltips(),b.loadColorPickers(),b.toggleAllOptionGroups(),h.trigger("wpformsFieldAdd",[i.data.field.id,n]))}else wpf.debug("Add field AJAX call is unsuccessful:",i)}).fail(function(e,i,o){l=!1,wpf.debug("Add field AJAX call failed:",e.responseText)}).always(function(){h.find(".wpforms-add-fields .wpforms-add-fields-button").prop("disabled",!1),l||(WPForms.Admin.Builder.DragFields.enableDragAndDrop(),b.enableFormActions())});b.addEntryPreviewField(n,s)}},fieldAddToBaseLevel:function(e,i,o){var t,r=g.$sortableFieldsWrap,n=r.find("> .wpforms-field"),s=n.last(),n=n.length,a=g.$fieldOptions;"top"===e.position?(r.prepend(i),a.prepend(o)):"bottom"!==e.position||s.length&&s.hasClass("wpforms-field-stick")?("bottom"===e.position&&(e.position=n),t=r.children(".wpforms-field").eq(e.position),e.position===n&&s.length&&s.hasClass("wpforms-field-stick")?(e=s.data("field-id"),s.before(i),a.find("#wpforms-field-option-"+e).before(o)):t.length?(n=t.data("field-id"),t.before(i),a.find("#wpforms-field-option-"+n).before(o)):(r.append(i),a.append(o))):(r.append(i),a.append(o))},scrollPreviewToField:function(e){var e=w("#wpforms-field-"+e),i=g.$fieldsPreviewWrap.scrollTop(),o=e.closest(".wpforms-field-layout");let t=e.position().top;e=(t=o.length?o.position().top+t+20:t)>i?t-i:t+i;g.$fieldsPreviewWrap.animate({scrollTop:e},1e3)},captchaUpdate:function(){var e={action:"wpforms_update_field_captcha",id:m.formID,nonce:wpforms_builder.nonce};return w.post(wpforms_builder.ajax_url,e,function(e){var i,o,t;e.success?(i={title:!1,content:!1,icon:"fa fa-exclamation-circle",type:"orange",boxWidth:"450px",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}},o=w("#wpforms-panel-field-settings-recaptcha"),t=e.data.current,o.data("provider",e.data.provider),"configured_not_enabled"!==t&&"configured_enabled"!==t||(t=o.prop("checked")?"configured_enabled":"configured_not_enabled",i.buttons.confirm.action=function(){o.prop("checked","configured_not_enabled"===t).trigger("change")}),i.title=e.data.cases[t].title,i.content=e.data.cases[t].content,e.data.cases[t].cancel&&(i.buttons.cancel={text:wpforms_builder.cancel,keys:["esc"]}),w.confirm(i)):console.log(e)}).fail(function(e,i,o){console.log(e.responseText)})},disableDragAndDrop:function(){console.warn('WARNING! Function "WPFormsBuilder.disableDragAndDrop()" has been deprecated, please use the new "WPForms.Admin.Builder.DragFields.disableDragAndDrop()" function instead!'),WPForms.Admin.Builder.DragFields.disableDragAndDrop()},enableDragAndDrop:function(){console.warn('WARNING! Function "WPFormsBuilder.enableDragAndDrop()" has been deprecated, please use the new "WPForms.Admin.Builder.DragFields.enableDragAndDrop()" function instead!'),WPForms.Admin.Builder.DragFields.enableDragAndDrop()},disableFormActions:function(){w.each([g.$previewButton,g.$embedButton,g.$saveButton,g.$exitButton],function(e,i){i.prop("disabled",!0).addClass("wpforms-disabled")})},enableFormActions:function(){w.each([g.$previewButton,g.$embedButton,g.$saveButton,g.$exitButton],function(e,i){i.prop("disabled",!1).removeClass("wpforms-disabled")})},fieldSortable:function(){console.warn('WARNING! Function "WPFormsBuilder.fieldSortable()" has been deprecated, please use the new "WPForms.Admin.Builder.DragFields.initSortableFields()" function instead!'),WPForms.Admin.Builder.DragFields.initSortableFields()},fieldDragDisable:function(e,i=!0){console.warn('WARNING! Function "WPFormsBuilder.fieldDragDisable()" has been deprecated, please use the new "WPForms.Admin.Builder.DragFields.fieldDragDisable()" function instead!'),WPForms.Admin.Builder.DragFields.fieldDragDisable(e,i)},fieldDragEnable:function(e){console.warn('WARNING! Function "WPFormsBuilder.fieldDragEnable()" has been deprecated, please use the new "WPForms.Admin.Builder.DragFields.fieldDragEnable()" function instead!'),WPForms.Admin.Builder.DragFields.fieldDragEnable(e)},fieldChoiceAdd:function(e,i){e.preventDefault();var e=w(i),i=e.parent(),o=i.find("input.default").is(":checked"),e=e.closest(".wpforms-field-option-row-choices").data("field-id"),t=i.parent().attr("data-next-id"),r=i.parent().data("field-type"),n=i.clone().insertAfter(i);n.attr("data-key",t),n.find("input.label").val("").attr("name","fields["+e+"][choices]["+t+"][label]"),n.find("input.value").val("").attr("name","fields["+e+"][choices]["+t+"][value]"),n.find(".wpforms-image-upload input.source").val("").attr("name","fields["+e+"][choices]["+t+"][image]"),n.find(".wpforms-icon-select input.source-icon").val(wpforms_builder.icon_choices.default_icon).attr("name","fields["+e+"][choices]["+t+"][icon]"),n.find(".wpforms-icon-select input.source-icon-style").val(wpforms_builder.icon_choices.default_icon_style).attr("name","fields["+e+"][choices]["+t+"][icon_style]"),n.find(".wpforms-icon-select .ic-fa-preview").removeClass().addClass("ic-fa-preview ic-fa-"+wpforms_builder.icon_choices.default_icon_style+" ic-fa-"+wpforms_builder.icon_choices.default_icon),n.find(".wpforms-icon-select .ic-fa-preview + span").text(wpforms_builder.icon_choices.default_icon),n.find("input.default").attr("name","fields["+e+"][choices]["+t+"][default]").prop("checked",!1),n.find(".preview").empty(),n.find(".wpforms-image-upload-add").show(),n.find(".wpforms-money-input").trigger("focusout"),!0===o&&i.find("input.default").prop("checked",!0),t++,i.parent().attr("data-next-id",t),h.trigger("wpformsFieldChoiceAdd"),b.fieldChoiceUpdate(r,e)},fieldChoiceDelete:function(e,i){e.preventDefault();var o,t=w(i),r=t.parent().parent(),e=r.find("li").length,i={id:r.data("field-id"),choiceId:t.closest("li").data("key"),message:"<strong>"+wpforms_builder.delete_choice_confirm+"</strong>",trigger:!1};h.trigger("wpformsBeforeFieldDeleteAlert",[i]),1===e?b.fieldChoiceDeleteAlert():(o=function(){t.parent().remove(),b.fieldChoiceUpdate(r.data("field-type"),r.data("field-id")),h.trigger("wpformsFieldChoiceDelete")},i.trigger?w.confirm({title:!1,content:i.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){o()}},cancel:{text:wpforms_builder.cancel}}}):o())},fieldChoiceDeleteAlert:function(){w.alert({title:!1,content:wpforms_builder.error_choice,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},fieldChoiceSortable:function(t,e){w(e=void 0!==e?e:".wpforms-field-option-"+t+" .wpforms-field-option-row-choices ul").sortable({items:"li",axis:"y",delay:100,opacity:.6,handle:".move",stop:function(e,i){var o=i.item.parent().data("field-id");b.fieldChoiceUpdate(t,o),h.trigger("wpformsFieldChoiceMove",i)},update:function(e,i){}})},fieldChoiceLabel:function(e,i){var o=void 0!==e.settings.choices[i].label&&0!==e.settings.choices[i].label.length?wpf.sanitizeHTML(e.settings.choices[i].label):wpforms_builder.choice_empty_label_tpl.replace("{number}",i);return e.settings.show_price_after_labels&&(o+=" - "+wpf.amountFormatCurrency(e.settings.choices[i].value)),o},fieldChoiceUpdate:function(n,e){var i,o,s,a,t,r,l,d,f,p,c=w("#wpforms-field-"+e+" .primary-input"),m=b.dropdownField.helpers.isDynamicChoices(e);"radio"===n||"checkbox"===n||"payment-multiple"===n||"payment-checkbox"===n?(i=wpf.getField(e),f=wpf.getChoicesOrder(e),o={},p=f.slice(0,20),t=wp.template("wpforms-field-preview-checkbox-radio-payment-multiple"),r={settings:i,order:p,type:"radio"},i.choices_icons&&(r.settings.choices_icons_color=b.getValidColorPickerValue(w("#wpforms-field-option-"+e+"-choices_icons_color"))),p.forEach(function(e){o[e]=i.choices[e]}),i.choices=o,"checkbox"!==n&&"payment-checkbox"!==n||(r.type="checkbox"),m||w("#wpforms-field-"+e).find("ul.primary-input").replaceWith(t(r)),b.firstNChoicesAlert(e,f.length)):(s=b.dropdownField.helpers.isModernSelect(c),a="","select"===(n="payment-select"===(n="payment-checkbox"===(n="payment-multiple"===n?"radio":n)?"checkbox":n)?"select":n)?m||(a='<option value="{label}">{label}</option>',c.find("option").not(".placeholder").remove()):"radio"!==n&&"checkbox"!==n&&"gdpr-checkbox"!==n||(n="gdpr-checkbox"===n?"checkbox":n,c.find("li").remove(),a='<li><input type="'+n+'" disabled>{label}</li>'),t=(p=w("#wpforms-field-option-row-"+e+"-choices .choices-list")).find("li").slice(0,20),r=!!p.find("input.default:checked").length,l=[],d=w("#wpforms-field-option-"+e+"-show_price_after_labels").prop("checked"),t.each(function(){var e,i=w(this),o=wpf.sanitizeHTML(i.find("input.label").val().trim()),t=i.find("input.value").val(),r=i.find("input.default").is(":checked"),i=i.data("key"),o=""!==o?o:wpforms_builder.choice_empty_label_tpl.replace("{number}",i);if(o+=d&&t?" - "+wpf.amountFormatCurrency(t):"",s?l.push({value:o,label:o}):m||(e=w(a.replace(/{label}/g,o)),c.append(e)),!0===r)switch(n){case"select":s?l[l.length-1].selected=!0:e.prop("selected","true");break;case"radio":case"checkbox":e.find("input").prop("checked","true")}}),s&&(f=c.prop("multiple")?"input.choices__input":".choices__inner .choices__placeholder",p=b.dropdownField.helpers.getInstance(c),m=w("#wpforms-field-option-"+e+"-dynamic_choices").val(),p.removeActiveItems(),p.setChoices(l,"value","label",!0),b.dropdownField.helpers.update(e,m),c.closest(".choices").find(f).toggleClass("wpforms-hidden",r)))},fieldChoiceBulkAddToggle:function(e){var e=w(e),i=e.closest("label");if(e.hasClass("bulk-add-showing")){var o=i.next(".bulk-add-display");o.slideUp(400,function(){o.remove()}),e.find("span").text(wpforms_builder.bulk_add_show)}else{var t,r=(r='<div class="bulk-add-display unfoldable-cont">')+('<p class="heading wpforms-clear">'+wpforms_builder.bulk_add_heading+' <a href="#" class="toggle-bulk-add-presets">'+wpforms_builder.bulk_add_presets_show+"</a></p>")+"<ul>";for(t in wpforms_preset_choices)r+='<li><a href="#" data-preset="'+t+'" class="bulk-add-preset-insert">'+wpforms_preset_choices[t].name+"</a></li>";r=(r=(r+="</ul>")+('<textarea placeholder="'+wpforms_builder.bulk_add_placeholder+'"></textarea>'))+('<button class="bulk-add-insert wpforms-btn wpforms-btn-sm wpforms-btn-blue">'+wpforms_builder.bulk_add_button+"</button>"),i.after(r+="</div>"),i.next(".bulk-add-display").slideDown(400,function(){w(this).find("textarea").trigger("focus")}),e.find("span").text(wpforms_builder.bulk_add_hide)}e.toggleClass("bulk-add-showing")},fieldChoiceBulkAddInsert:function(e){var i,o,t,e=w(e),r=e.closest(".wpforms-field-option-row"),n=r.find("textarea"),s=r.find(".choices-list"),a=s.find("li:first-of-type").clone().wrap("<div>").parent(),l=r.data("field-id"),d=s.data("field-type"),f=Number(s.attr("data-next-id")),p=n.val().split("\n"),c="";for(o in e.prop("disabled",!0).html(e.html()+" "+m.spinner),a.find("input.value,input.label").attr("value",""),a.find("input.default").attr("checked",!1),a.find("input.source-icon").attr("value",wpforms_builder.icon_choices.default_icon),a.find("input.source-icon-style").attr("value",wpforms_builder.icon_choices.default_icon_style),a.find(".ic-fa-preview").removeClass().addClass(`ic-fa-preview ic-fa-${wpforms_builder.icon_choices.default_icon_style} ic-fa-`+wpforms_builder.icon_choices.default_icon),a.find(".ic-fa-preview + span").text(wpforms_builder.icon_choices.default_icon),i=a.html(),p)p.hasOwnProperty(o)&&(t=wpf.sanitizeHTML(p[o]).trim().replace(/"/g,"&quot;"),c+=i.replace(/\[choices\]\[(\d+)\]/g,"[choices]["+f+"]").replace(/data-key="(\d+)"/g,'data-key="'+f+'"').replace(/value="" class="label"/g,'value="'+t+'" class="label"').replace(/class="label" type="text" value=""/g,'class="label" type="text" value="'+t+'"'),f++);s.attr("data-next-id",f).append(c),b.fieldChoiceUpdate(d,l),h.trigger("wpformsFieldChoiceAdd"),b.fieldChoiceBulkAddToggle(r.find(".toggle-bulk-add-display"))},fieldTabToggle:function(e){var i;if(WPFormsUtils.triggerEvent(h,"wpformsFieldTabToggle",[e]).isDefaultPrevented())return!1;w(".wpforms-tab a").removeClass("active"),w(".wpforms-field, .wpforms-title-desc").removeClass("active"),"add-fields"===e?(w("#add-fields a").addClass("active"),w(".wpforms-field-options").hide(),w(".wpforms-add-fields").show()):(w("#field-options a").addClass("active"),"field-options"===e?((i=w(".wpforms-field").first()).addClass("active"),e=i.data("field-id")):w("#wpforms-field-"+e).addClass("active"),w(".wpforms-field-option").hide(),w("#wpforms-field-option-"+e).show(),w(".wpforms-add-fields").hide(),w(".wpforms-field-options").show(),h.trigger("wpformsFieldOptionTabToggle",[e]))},fieldPagebreakAdd:function(e,i,o){"pagebreak"===o&&(m.pagebreakTop?m.pagebreakBottom||(m.pagebreakBottom=!0,b.fieldAdd("pagebreak",{position:"bottom",scroll:!1,defaults:{position:"bottom"}}).done(function(e){m.pagebreakBottom=e.data.field.id;var i=w("#wpforms-field-"+e.data.field.id);w("#wpforms-field-option-"+e.data.field.id).find(".wpforms-field-option-group").addClass("wpforms-pagebreak-bottom"),i.addClass("wpforms-field-stick wpforms-pagebreak-bottom")})):(m.pagebreakTop=!0,b.fieldAdd("pagebreak",{position:"top",scroll:!1,defaults:{position:"top",nav_align:"left"}}).done(function(e){m.pagebreakTop=e.data.field.id;var i=w("#wpforms-field-"+e.data.field.id);w("#wpforms-field-option-"+e.data.field.id).find(".wpforms-field-option-group").addClass("wpforms-pagebreak-top"),i.addClass("wpforms-field-stick wpforms-pagebreak-top")})))},fieldPagebreakDelete:function(e,i,o){var t,r,n;"pagebreak"!==o||w("#wpforms-panel-fields .wpforms-field-pagebreak").not(".wpforms-pagebreak-top, .wpforms-pagebreak-bottom").length||(r=(t=(o=w("#wpforms-panel-fields .wpforms-preview-wrap")).find(".wpforms-pagebreak-top")).data("field-id"),n=(o=o.find(".wpforms-pagebreak-bottom")).data("field-id"),t.remove(),w("#wpforms-field-option-"+r).remove(),m.pagebreakTop=!1,o.remove(),w("#wpforms-field-option-"+n).remove(),m.pagebreakBottom=!1)},fieldPageBreakInitDisplayPrevious:function(e){var i=e.data("field-id"),o=w("#wpforms-field-option-row-"+i+"-prev_toggle"),i=w("#wpforms-field-option-row-"+i+"-prev"),t=e.find(".wpforms-pagebreak-prev");0<e.prevAll(".wpforms-field-pagebreak.wpforms-pagebreak-normal").length?(o.removeClass("hidden"),i.removeClass("hidden"),o.find("input").is(":checked")&&t.removeClass("wpforms-hidden").text(i.find("input").val())):(o.addClass("hidden"),i.addClass("hidden"),t.addClass("wpforms-hidden"))},fieldDynamicChoiceToggle:function(e){var e=w(e),i=e.parent(),o=e.val(),t=i.data("field-id"),r=w("#wpforms-field-option-"+t).find(".wpforms-field-option-hidden-type").val(),e=w("#wpforms-field-"+t),n=w("#wpforms-field-option-row-"+t+"-choices"),s=w("#wpforms-field-option-"+t+"-choices_images"),a=w("#wpforms-field-option-"+t+"-choices_icons");if(b.fieldDynamicChoiceToggleImageChoices(),b.fieldDynamicChoiceToggleIconChoices(),h.trigger("wpformsFieldDynamicChoiceToggle"),wpf.fieldOptionLoading(i),w("#wpforms-field-option-row-"+t+"-dynamic_post_type").remove(),w("#wpforms-field-option-row-"+t+"-dynamic_taxonomy").remove(),""!==o)s.addClass("wpforms-hidden"),a.addClass("wpforms-hidden"),n.find(".toggle-bulk-add-display").addClass("wpforms-hidden"),p={type:o,field_id:t,action:"wpforms_builder_dynamic_choices",nonce:wpforms_builder.nonce},w.post(wpforms_builder.ajax_url,p,function(e){e.success?i.after(e.data.markup):console.log(e),wpf.fieldOptionLoading(i,!0),wpf.initTooltips(),w("#wpforms-field-option-"+t+"-dynamic_"+o).find("option").first().prop("selected",!0),w("#wpforms-field-option-"+t+"-dynamic_"+o).trigger("change")}).fail(function(e,i,o){console.log(e.responseText)});else{if(s.removeClass("wpforms-hidden"),a.removeClass("wpforms-hidden"),n.find(".toggle-bulk-add-display").removeClass("wpforms-hidden"),w("#wpforms-field-"+t).find(".wpforms-alert").remove(),-1<["checkbox","radio","payment-multiple","payment-checkbox"].indexOf(r))b.fieldChoiceUpdate(r,t),n.find("ul").removeClass("wpforms-hidden"),n.find(".wpforms-alert").addClass("wpforms-hidden");else{var l,d=[],f=e.find(".primary-input");if(w("#wpforms-field-option-row-"+t+"-choices li").each(function(){var e=w(this);d.push({label:wpf.sanitizeHTML(e.find(".label").val()),selected:e.find(".default").is(":checked")})}),e.hasClass("wpforms-field-select")){var p=b.dropdownField.helpers.isModernSelect(f),c="";if(f.find("option").not(".placeholder").remove(),p&&d.length)b.dropdownField.helpers.update(t,!1);else for(l in d)c="<option",c=(c+=d[l].selected?" selected>":">")+d[l].label+"</option>",f.append(c)}else for(l in r="radio",e.hasClass("wpforms-field-checkbox")&&(r="checkbox"),f.empty(),d)c='<li><input type="'+r+'" disabled',c=(c+=d[l].selected?" selected>":">")+d[l].label+"</li>",f.append(c);n.find("ul").removeClass("wpforms-hidden"),n.find(".wpforms-alert").addClass("wpforms-hidden"),f.removeClass("wpforms-hidden")}wpf.fieldOptionLoading(i,!0)}},fieldDynamicChoiceSource:function(e){var e=w(e),o=e.parent(),e=e.val(),t=o.data("field-id"),i=w("#wpforms-builder-form").data("id"),r=w("#wpforms-field-option-row-"+t+"-choices"),n=w("#wpforms-field-"+t),s=w("#wpforms-field-option-"+t+"-dynamic_choices option:selected").val(),a=20,s=(wpf.fieldOptionLoading(o),{type:s,source:e,field_id:t,form_id:i,action:"wpforms_builder_dynamic_source",nonce:wpforms_builder.nonce});w.post(wpforms_builder.ajax_url,s,function(e){var i;e.success?(r.find(".dynamic-name").text(e.data.source_name),r.find(".dynamic-type").text(e.data.type_name),r.find("ul").addClass("wpforms-hidden"),r.find(".wpforms-alert").removeClass("wpforms-hidden"),b.fieldDynamicChoiceSourceItems(n,e.data.items),n.hasClass("wpforms-field-select")&&(a=200),Number(e.data.total)>a&&(i=(i=(i=(i=(i=wpforms_builder.dynamic_choice_limit).replace("{source}",e.data.source_name)).replace("{type}",e.data.type_name)).replace("{limit}",a)).replace("{total}",e.data.total),w.alert({title:wpforms_builder.heads_up,content:i,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})),b.firstNChoicesAlert(t,e.data.total)):console.log(e),wpf.fieldOptionLoading(o,!0)}).fail(function(e,i,o){console.log(e.responseText)})},fieldDynamicChoiceSourceItems:function(e,i){var o=e.find(".primary-input"),t=0;if(e.hasClass("wpforms-field-select"))b.dropdownField.helpers.isModernSelect(o)?b.fieldDynamicChoiceSourceForModernSelect(o,i):b.fieldDynamicChoiceSourceForClassicSelect(o,i);else{var r="radio";for(t in e.hasClass("wpforms-field-checkbox")&&(r="checkbox"),o.empty(),i)o.append('<li><input type="'+r+'" disabled> '+wpf.sanitizeHTML(i[t])+"</li>")}},fieldDynamicChoiceSourceForModernSelect:function(e,i){var o=b.dropdownField.helpers.getInstance(e),t=e.closest(".wpforms-field").data().fieldId;o.destroy(),b.dropdownField.helpers.updatePlaceholderChoice(o,t),b.fieldDynamicChoiceSourceForClassicSelect(e,i),b.dropdownField.events.choicesInit(e)},fieldDynamicChoiceSourceForClassicSelect:function(e,i){var o=0,t=i.length;for(e.find("option").not(".placeholder").remove();o<t;o++){var r=wpf.sanitizeHTML(i[o]);e.append('<option value="'+r+'">'+r+"</option>")}e.toggleClass("wpforms-hidden",!t)},fieldDynamicChoiceToggleImageChoices:function(){w("#wpforms-builder .wpforms-field-options .wpforms-field-option").each(function(e,i){var i=w(i),o=i.find(".wpforms-field-option-row-dynamic_choices select").val(),o=void 0!==o&&""!==o,t=i.find(".wpforms-field-option-row-choices_images input").is(":checked");i.find(".wpforms-field-option-row-choices_images").toggleClass("wpforms-hidden",o),t&&!o||i.find(".wpforms-field-option-row-choices_images_style").addClass("wpforms-hidden")})},fieldDynamicChoiceToggleIconChoices:function(){w("#wpforms-builder .wpforms-field-options .wpforms-field-option").each(function(e,i){var i=w(i),o=i.find(".wpforms-field-option-row-dynamic_choices select").val(),o=void 0!==o&&""!==o,t=i.find(".wpforms-field-option-row-choices_icons input").is(":checked");i.find(".wpforms-field-option-row-choices_icons").toggleClass("wpforms-hidden",o),t&&!o||(i.find(".wpforms-field-option-row-choices_icons_color").addClass("wpforms-hidden"),i.find(".wpforms-field-option-row-choices_icons_size").addClass("wpforms-hidden"),i.find(".wpforms-field-option-row-choices_icons_style").addClass("wpforms-hidden"))})},firstNChoicesAlert:function(e,i){var o=wp.template("wpforms-choices-limit-message"),t={total:i},e=w("#wpforms-field-"+e);e.hasClass("wpforms-field-select")||(e.find(".wpforms-alert-dynamic").remove(),20<i&&e.find(".primary-input").after(o(t)))},fieldLayoutSelectorToggle:function(e){var e=w(e),i=e.closest("label").next(".layout-selector-display");e.hasClass("layout-selector-showing")?(i.slideUp(400),e.find("span").text(wpforms_builder.layout_selector_show)):(i.slideDown(),e.find("span").text(wpforms_builder.layout_selector_hide)),e.toggleClass("layout-selector-showing")},fieldLayoutSelectorInit:function(o){var e=w(`#wpforms-field-option-row-${o}-css > .layout-selector-display`);if(!e.length){var t,r={"layout-1":[{class:"one-half",data:"wpforms-one-half wpforms-first"},{class:"one-half",data:"wpforms-one-half"}],"layout-2":[{class:"one-third",data:"wpforms-one-third wpforms-first"},{class:"one-third",data:"wpforms-one-third"},{class:"one-third",data:"wpforms-one-third"}],"layout-3":[{class:"one-fourth",data:"wpforms-one-fourth wpforms-first"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"one-fourth",data:"wpforms-one-fourth"}],"layout-4":[{class:"one-third",data:"wpforms-one-third wpforms-first"},{class:"two-third",data:"wpforms-two-thirds"}],"layout-5":[{class:"two-third",data:"wpforms-two-thirds wpforms-first"},{class:"one-third",data:"wpforms-one-third"}],"layout-6":[{class:"one-fourth",data:"wpforms-one-fourth wpforms-first"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"two-fourth",data:"wpforms-two-fourths"}],"layout-7":[{class:"two-fourth",data:"wpforms-two-fourths wpforms-first"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"one-fourth",data:"wpforms-one-fourth"}],"layout-8":[{class:"one-fourth",data:"wpforms-one-fourth wpforms-first"},{class:"two-fourth",data:"wpforms-two-fourths"},{class:"one-fourth",data:"wpforms-one-fourth"}]};let e,i=`<div class="layout-selector-display unfoldable-cont">
					<p class="heading">${wpforms_builder.layout_selector_layout}</p>
					<div class="layouts">`;for(t in r){for(var n in e=r[t],i+='<div class="layout-selector-display-layout">',e)i+=`<span class="${e[n].class}" data-classes="${e[n].data}"></span>`;i+="</div>"}i+="</div></div>",w(`#wpforms-field-option-row-${o}-css > label`).after(i)}},fieldLayoutSelectorLayout:function(e){e=w(e);e.parent().find(".layout-selector-display-layout").not(e).remove(),e.parent().find(".heading").text(wpforms_builder.layout_selector_column),e.toggleClass("layout-selector-display-layout layout-selector-display-columns")},fieldLayoutSelectorInsert:function(e){var e=w(e),i=e.closest(".layout-selector-display"),o=i.parent(),t=o.find("label"),o=o.find("input[type=text]"),e=e.data("classes");o.val()&&(e=" "+e),o.insertAtCaret(e),i.slideUp(400,function(){i.remove()}),t.find(".toggle-layout-selector-display").removeClass("layout-selector-showing"),t.find(".toggle-layout-selector-display span").text(wpforms_builder.layout_selector_show)},bindUIActionsSettings:function(){h.on("click","#wpforms-panel-fields .wpforms-title-desc, #wpforms-panel-fields .wpforms-field-submit-button, .wpforms-center-form-name",function(e){e.preventDefault(),b.panelSwitch("settings"),(w(this).hasClass("wpforms-center-form-name")||w(this).hasClass("wpforms-title-desc"))&&setTimeout(function(){w("#wpforms-panel-field-settings-form_title").trigger("focus")},300)}),h.on("click",".wpforms-field-pagebreak-last button",function(e){e.preventDefault(),b.panelSwitch("settings"),w("#wpforms-panel-field-settings-pagebreak_prev").trigger("focus")}),h.on("click",".wpforms-panel-content-also-available-item-add-captcha",function(e){e.preventDefault();e=h.find("#wpforms-add-fields-captcha");e.data("action")?e.trigger("click"):b.fieldAdd("captcha",{}).done(function(){b.panelSwitch("fields")})}),h.on("input","#wpforms-panel-field-settings-pagebreak_prev",function(){w(".wpforms-field-pagebreak-last button").text(w(this).val())}),h.on("input","#wpforms-panel-field-settings-form_title, #wpforms-setup-name",function(){var e=w(this).val().toString().trim();w(".wpforms-preview .wpforms-form-name").text(e),w(".wpforms-center-form-name.wpforms-form-name").text(e),b.trimFormTitle()}),h.on("input","#wpforms-panel-field-settings-form_desc",function(){w(".wpforms-form-desc").text(w(this).val())}),h.on("input","#wpforms-panel-field-settings-submit_text",function(){w(".wpforms-field-submit input[type=submit]").val(w(this).val())}),h.on("change","#wpforms-panel-field-settings-recaptcha",function(){b.captchaToggle()}),h.on("change",".wpforms-panel-field-confirmations-type",function(){b.confirmationFieldsToggle(w(this))}),h.on("change",".wpforms-panel-field-confirmations-message_entry_preview",b.confirmationEntryPreviewToggle),h.on("change","#wpforms-panel-field-settings-notification_enable",function(){b.notificationToggle()}),h.on("click",".wpforms-builder-settings-block-add",function(e){e.preventDefault(),wpforms_builder.pro&&b.settingsBlockAdd(w(this))}),h.on("click",".wpforms-builder-settings-block-edit",function(e){e.preventDefault();e=w(this);e.parents(".wpforms-builder-settings-block-header").find(".wpforms-builder-settings-block-name").hasClass("editing")?b.settingsBlockNameEditingHide(e):b.settingsBlockNameEditingShow(e)}),h.on("blur",".wpforms-builder-settings-block-name-edit input",function(e){w(e.relatedTarget).hasClass("wpforms-builder-settings-block-edit")||b.settingsBlockNameEditingHide(w(this))}),h.on("keypress",".wpforms-builder-settings-block-name-edit input",function(e){13===e.keyCode&&(b.settingsBlockNameEditingHide(w(this)),e.preventDefault())}),h.on("click",".wpforms-builder-settings-block-clone",function(e){e.preventDefault(),b.settingsBlockPanelClone(w(this))}),h.on("click",".wpforms-builder-settings-block-toggle",function(e){e.preventDefault(),b.settingsBlockPanelToggle(w(this))}),h.on("click",".wpforms-builder-settings-block-delete",function(e){e.preventDefault(),b.settingsBlockDelete(w(this))})},captchaToggle:function(){var e=h.find(".wpforms-field-recaptcha"),i=w("#wpforms-panel-field-settings-recaptcha"),o=i.data("provider")||"recaptcha";e.length&&(i.is(":checked")?e.show().toggleClass("is-recaptcha","recaptcha"===o):e.hide())},confirmationsSetup:function(){w(".wpforms-panel-field-confirmations-type").each(function(){b.confirmationFieldsToggle(w(this))}),w(".wpforms-panel-field-confirmations-message").each(function(){"undefined"!=typeof tinymce&&void 0!==wp.editor&&wp.editor.initialize(w(this).attr("id"),m.tinymceDefaults)}),h.on("focusout",".wpforms-panel-field-confirmations-redirect",function(e){const i=w(this);var o=i.val().trim();i.val(o),wpf.isURL(o)||""===o||b.confirmationRedirectValidationError(function(){i.trigger("focus")})}),h.on("wpformsBeforeSave wpformsPanelSectionSwitch wpformsPanelSwitch",function(r){w(".wpforms-confirmation").each(function(e,i){var i=w(i),o=i.find(".wpforms-panel-field-confirmations-type");const t=i.find(".wpforms-panel-field-confirmations-redirect");if(!t.is(":hidden")&&!("redirect"!==o.val()||0<t.val().trim().length))return b.confirmationRedirectValidationError(function(){t.trigger("focus")}),r.stopImmediatePropagation(),r.preventDefault(),!1})})},confirmationRedirectValidationError:function(e){w.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.redirect_url_field_error,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}},onDestroy:e})},confirmationFieldsToggle:function(e){var i,o;e.length&&(i=e.val(),(o=e.closest(".wpforms-builder-settings-block-content")).find(".wpforms-panel-field").not(e.parent()).not(".wpforms-conditionals-enable-toggle").hide(),o.find(".wpforms-panel-field-confirmations-"+i).closest(".wpforms-panel-field").show(),"message"===i)&&(o.find(".wpforms-panel-field-confirmations-message_scroll").closest(".wpforms-panel-field").show(),o.find(".wpforms-panel-field-confirmations-message_entry_preview").trigger("change").closest(".wpforms-panel-field").show())},confirmationEntryPreviewToggle:function(){var e=w(this),i=e.closest(".wpforms-builder-settings-block-content").find(".wpforms-panel-field-confirmations-message_entry_preview_style").parent();e.is(":checked")?i.show():i.hide()},notificationToggle:function(){var e=w("#wpforms-panel-field-settings-notification_enable"),i=e.closest(".wpforms-panel-content-section").find(".wpforms-builder-settings-block"),e=e.is(":checked");w(".wpforms-notifications-add").toggleClass("wpforms-hidden",!e),e?i.show():i.hide()},notificationsByStatusAlerts:function(){h.on("change",".wpforms-panel-content-section-notifications .wpforms-notification-by-status-alert",function(e){var i,o,t=w(this);t.prop("checked")&&(o="",o=0===(i=w(".wpforms-radio-group-"+t.attr("data-radio-group")+":checked:not(#"+t.attr("id")+")")).length?(o=wpforms_builder.notification_by_status_enable_alert).replace(/%s/g,t.data("provider-title")):(o=(o=wpforms_builder.notification_by_status_switch_alert).replace(/%2\$s/g,i.data("provider-title"))).replace(/%1\$s/g,t.data("provider-title")),w.confirm({title:wpforms_builder.heads_up,content:o,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm"}}}))})},settingsBlockAdd:function(a){var l=Number(a.attr("data-next-id")),d=a.closest(".wpforms-panel-content-section").data("panel"),f=a.data("block-type"),e=wpforms_builder[f+"_prompt"],i='<input autofocus="" type="text" id="settings-block-name" placeholder="'+wpforms_builder[f+"_ph"]+'">',o='<p class="error">'+wpforms_builder[f+"_error"]+"</p>",t=w.confirm({container:h,title:!1,content:e+i+o,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e=this.$content.find("input#settings-block-name").val().toString().trim(),i=this.$content.find(".error");if(""===e)return i.show(),!1;var i=a.closest(".wpforms-panel-content-section").find(".wpforms-builder-settings-block").first(),o=(wpf.restoreTooltips(i),i.clone()),t=i.data("block-id"),n=(o.attr("data-block-id",l),o.find(".wpforms-builder-settings-block-header span").text(e),o.find("input, textarea, select").not(".from-name input").not(".from-email input").each(function(e,i){var o=w(this);o.attr("name")&&(o.val("").attr("name",o.attr("name").replace(/\[(\d+)\]/,"["+l+"]")),o.is("select")?(o.find("option").prop("selected",!1).attr("selected",!1),o.find("option").first().prop("selected",!0).attr("selected","selected")):"checkbox"===o.attr("type")?o.prop("checked",!1).attr("checked",!1).val("1"):o.val("").attr("value",""))}),"wpforms-panel-field-"+d+"-"),s=n+t,r=(o.find('[id^="'+s+'"], [for^="'+s+'"]').each(function(e,i){var o=w(this),t="LABEL"===o.prop("tagName")?"for":"id",r=o.attr(t).replace(new RegExp(s,"g"),n+l);o.attr(t,r)}),t+"-notification-by-status"),t=(o.find('[data-radio-group="'+r+'"]').each(function(e,i){w(this).removeClass("wpforms-radio-group-"+r).addClass("wpforms-radio-group-"+l+"-notification-by-status").attr("data-radio-group",l+"-notification-by-status")}),o.find(".wpforms-builder-settings-block-header input").val(e).attr("value",e),"notification"===f&&(o.find(".email-msg textarea").val("{all_fields}").attr("value","{all_fields}"),o.find(".email-recipient input").val("{admin_email}").attr("value","{admin_email}")),o.removeClass("wpforms-builder-settings-block-default"),"confirmation"===f&&(o.find(".wpforms-panel-field-tinymce").remove(),"undefined"!=typeof WPForms)&&o.find(".wpforms-panel-field-confirmations-type-wrap").after(WPForms.Admin.Builder.Templates.get("wpforms-builder-confirmations-message-field")({id:l})),o.find(".wpforms-conditional-block")),e=(t.length&&"undefined"!=typeof WPForms&&t.html(WPForms.Admin.Builder.Templates.get("wpforms-builder-conditional-logic-toggle-field")({id:l,type:f,actions:JSON.stringify(o.find(".wpforms-panel-field-conditional_logic-checkbox").data("actions")),actionDesc:o.find(".wpforms-panel-field-conditional_logic-checkbox").data("action-desc")})),o.find(".wpforms-field-map-table")),e=(e.length&&e.each(function(e,i){var i=w(i),o=(i.find("tr:not(:first-child)").remove(),i.find(".key input")),i=i.find(".field select"),t=i.data("name");o.attr("value",""),i.attr("name","").attr("data-name",t.replace(/\[(\d+)\]/,"["+l+"]"))}),t=(t=o.wrap("<div>").parent().html()).replace(/\[conditionals\]\[(\d+)\]\[(\d+)\]/g,"[conditionals][0][0]"),i.before(t),i.prev());"confirmation"===f&&(b.prepareChoicesJSField(e,l),b.confirmationFieldsToggle(w(".wpforms-panel-field-confirmations-type").first())),"undefined"!=typeof tinymce&&void 0!==wp.editor&&"confirmation"===f&&wp.editor.initialize("wpforms-panel-field-confirmations-message-"+l,m.tinymceDefaults),wpf.initTooltips(),h.trigger("wpformsSettingsBlockAdded",[e]),a.attr("data-next-id",l+1)}},cancel:{text:wpforms_builder.cancel}}});h.on("keypress","#settings-block-name",function(e){13===e.keyCode&&w(t.buttons.confirm.el).trigger("click")})},prepareChoicesJSField:function(e,i){var o,e=e.find(`#wpforms-panel-field-confirmations-${i}-page-wrap`);e.length<=0||(i=e.find(`#wpforms-panel-field-confirmations-${i}-page`)).length<=0&&!i.hasClass("choicesjs-select")||(o=e.find(".choices")).length<=0||((i=i.first()).removeAttr("data-choice"),i.removeAttr("hidden"),i.removeClass("choices__input"),w(i).appendTo(e.first()),o.first().remove(),b.dropdownField.events.choicesInit(i))},settingsBlockNameEditingShow:function(e){e=e.parents(".wpforms-builder-settings-block-header");e.find(".wpforms-builder-settings-block-name").addClass("editing").hide(),e.find(".wpforms-builder-settings-block-name-edit").addClass("active"),wpf.focusCaretToEnd(e.find("input"))},settingsBlockNameEditingHide:function(e){var i=e.parents(".wpforms-builder-settings-block-header"),o=i.find(".wpforms-builder-settings-block-name"),i=i.find(".wpforms-builder-settings-block-name-edit"),t=i.find("input").val().trim(),e=e.closest(".wpforms-builder-settings-block").data("block-type");t.length||(t=wpforms_builder[e+"_def_name"]),i.find("input").val(t),o.text(t),o.removeClass("editing").show(),i.removeClass("active")},settingsBlockPanelClone:function(e){var i=e.closest(".wpforms-panel-content-section").find(".wpforms-builder-settings-block-add"),e=e.closest(".wpforms-builder-settings-block"),o=e.find(".wpforms-builder-settings-block-content"),t=parseInt(i.attr("data-next-id"),10),r=e.data("block-type"),n=e.find(".wpforms-builder-settings-block-name").text().trim()+wpforms_builder[r+"_clone"],o=o.is(":hidden"),s=(wpf.restoreTooltips(e),e.clone(!1,!0));b.settingsBlockUpdateState(o,t,r),s.data("block-id",t),s.find(".wpforms-builder-settings-block-header span").text(n),s.find(".wpforms-builder-settings-block-header input").val(n),s.removeClass("wpforms-builder-settings-block-default"),i.attr("data-next-id",t+1),s.find("input, textarea, select").each(function(){var e=w(this);e.attr("name")&&e.attr("name",e.attr("name").replace(/\[(\d+)\]/,"["+t+"]")),e.data("name")&&e.data("name",e.data("name").replace(/\[(\d+)\]/,"["+t+"]")),e.attr("class")&&e.attr("class",e.attr("class").replace(/-(\d+)/,"-"+t)),e.attr("data-radio-group")&&e.attr("data-radio-group",e.attr("data-radio-group").replace(/(\d+)-/,t+"-"))}),s.find("*").each(function(){var e=w(this);e.attr("id")&&e.attr("id",e.attr("id").replace(/-(\d+)/,"-"+t)),e.attr("for")&&e.attr("for",e.attr("for").replace(/-(\d+)-/,"-"+t+"-")),e.data("input-name")&&e.data("input-name",e.data("input-name").replace(/\[(\d+)\]/,"["+t+"]"))}),e.find("select").each(function(){var e=w(this).attr("name"),i=w(this).attr("name").replace(/\[(\d+)\]/,"["+t+"]");s.find('select[name="'+i+'"]').val(w(this).attr("name",e).val())}),s.css("display","none").insertBefore(e).show("fast",function(){wpf.initTooltips()}),h.trigger("wpformsSettingsBlockCloned",[s,e.data("block-id")])},settingsBlockPanelToggle:function(e){var i=e.closest(".wpforms-builder-settings-block"),o=i.data("block-id"),t=i.data("block-type"),r=i.find(".wpforms-builder-settings-block-content"),n=r.is(":visible");r.stop().slideToggle({duration:400,start:function(){b.settingsBlockUpdateState(n,o,t)},always:function(){r.is(":visible")?e.html('<i class="fa fa-chevron-circle-up"></i>'):e.html('<i class="fa fa-chevron-circle-down"></i>')}})},settingsBlockDelete:function(e){var i=e.closest(".wpforms-panel-content-section"),o=e.closest(".wpforms-builder-settings-block"),t=o.data("block-type");i.find(".wpforms-builder-settings-block").length<2||w.confirm({title:!1,content:wpforms_builder[t+"_delete"],icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e=o.data("block-id"),i=o.data("block-type");w.post(wpforms_builder.ajax_url,{action:"wpforms_builder_settings_block_state_remove",nonce:wpforms_builder.nonce,block_id:e,block_type:i,form_id:m.formID}),o.remove(),h.trigger("wpformsSettingsBlockDeleted",[t,e])}},cancel:{text:wpforms_builder.cancel}}})},settingsBlockUpdateState:function(e,i,o){w.post(wpforms_builder.ajax_url,{action:"wpforms_builder_settings_block_state_save",state:e?"closed":"opened",form_id:m.formID,block_id:i,block_type:o,nonce:wpforms_builder.nonce})},bindUIActionsRevisions:function(){h.on("wpformsPanelSwitched",function(e,i){"revisions"===i&&(b.updateRevisionsList(),b.updateRevisionPreview())}),h.on("wpformsSaved",function(e){"revisions"===wpf.getQueryString("view")&&b.updateRevisionsList()})},updateRevisionsList:function(){var t=w("#wpforms-panel-revisions .wpforms-revisions-content"),i=w(".wpforms-panel-revisions-button .badge-exclamation");i.length&&w.post(wpforms_builder.ajax_url,{action:"wpforms_mark_panel_viewed",form_id:m.formID,nonce:wpforms_builder.nonce}).done(function(e){e.success?i.remove():wpf.debug(e)}).fail(function(e,i,o){wpf.debug(e.responseText||i||"")}),h.hasClass("wpforms-revisions-enabled")&&t.fadeTo(250,.25,function(){w.post(wpforms_builder.ajax_url,{action:"wpforms_get_form_revisions",form_id:m.formID,revision_id:wpf.getQueryString("revision_id"),nonce:wpforms_builder.nonce}).done(function(e){e.success?t.replaceWith(e.data.html):wpf.debug(e)}).fail(function(e,i,o){wpf.debug(e.responseText||i||""),t.fadeTo(250,1)})})},updateRevisionPreview:function(){var e=g.$formPreview.clone();e.find(".wpforms-field-duplicate, .wpforms-field-delete, .wpforms-field-helper, .wpforms-debug").remove().end(),e.find(".wpforms-field-wrap").removeClass("ui-sortable").addClass("ui-sortable-disabled"),e.find(".wpforms-field").removeClass("ui-sortable-handle ui-draggable ui-draggable-handle active").removeAttr("id data-field-id data-field-type").removeData(),e.find(".wpforms-field-submit-button").prop("disabled",!0),g.$revisionPreview.hasClass("has-preview")?g.$revisionPreview.find(".wpforms-preview-wrap").replaceWith(e):g.$revisionPreview.append(e).addClass("has-preview")},confirmSaveRevision:function(){w.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.revision_update_confirm,icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!1,buttons:{confirm:{text:wpforms_builder.save,btnClass:"btn-confirm",keys:["enter"],action:function(){h.addClass("wpforms-revision-is-saving"),WPFormsBuilder.formSave(!1).done(b.revisionSavedReload)}},cancel:{text:wpforms_builder.cancel,action:function(){WPFormsBuilder.setCloseConfirmation(!0)}}}})},revisionSavedReload:function(){wpf.updateQueryString("view",wpf.getQueryString("view")),wpf.removeQueryParam("revision_id"),a.location.reload()},bindUIActionsSaveExit:function(){h.on("click","#wpforms-embed",function(e){e.preventDefault(),w(this).hasClass("wpforms-disabled")||WPFormsFormEmbedWizard.openPopup()}),h.on("click","#wpforms-save",function(e){e.preventDefault(),b.formSave(!1)}),h.on("click","#wpforms-exit",function(e){e.preventDefault(),b.formExit()}),h.on("wpformsSaved",function(e,i){wpf.removeQueryParam("newform")})},formSave:function(i){var e=g.$saveButton,o=e.find("i.fa-check"),t=e.find("i.wpforms-loading-spinner"),r=e.find("span"),n=r.text();if(h.hasClass("wpforms-is-revision")&&!h.hasClass("wpforms-revision-is-saving"))b.confirmSaveRevision();else{"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();var s=WPFormsUtils.triggerEvent(h,"wpformsBeforeSave");if(!s.isDefaultPrevented())return r.text(wpforms_builder.saving),e.prop("disabled",!0),o.addClass("wpforms-hidden"),t.removeClass("wpforms-hidden"),s={action:"wpforms_save_form",data:JSON.stringify(w("#wpforms-builder-form").serializeArray()),id:m.formID,nonce:wpforms_builder.nonce},w.post(wpforms_builder.ajax_url,s,function(e){e.success?(wpf.savedState=wpf.getFormState("#wpforms-builder-form"),wpf.initialSave=!1,h.trigger("wpformsSaved",e.data),!0===i&&b.isBuilderInPopup()?b.builderInPopupClose("saved"):!0===i&&(a.location.href=wpforms_builder.exit_url)):(wpf.debug(e),b.formSaveError(e.data))}).fail(function(e,i,o){wpf.debug(e),b.formSaveError()}).always(function(){r.text(n),e.prop("disabled",!1),t.addClass("wpforms-hidden"),o.removeClass("wpforms-hidden")})}},formSaveError:function(e){wpf.empty(e)&&(e=wpforms_builder.error_save_form),w.confirm({title:wpforms_builder.heads_up,content:"<p>"+e+"</p><p>"+wpforms_builder.error_contact_support+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},formExit:function(){b.isBuilderInPopup()&&b.formIsSaved()?b.builderInPopupClose("saved"):b.formIsSaved()?a.location.href=wpforms_builder.exit_url:w.confirm({title:!1,content:wpforms_builder.exit_confirm,icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!0,buttons:{confirm:{text:wpforms_builder.save_exit,btnClass:"btn-confirm",keys:["enter"],action:function(){b.formSave(!0)}},cancel:{text:wpforms_builder.exit,action:function(){i=!1,b.isBuilderInPopup()?b.builderInPopupClose("canceled"):a.location.href=wpforms_builder.exit_url}}}})},setCloseConfirmation:function(e){i=!!e},formIsSaved:function(){return wpf.savedState==wpf.getFormState("#wpforms-builder-form")},isBuilderInPopup:function(){return a.self!==a.parent&&"wpforms-builder-iframe"===a.self.frameElement.id},builderInPopupClose:function(e){var i=a.parent.jQuery("#wpforms-builder-elementor-popup");i.find("#wpforms-builder-iframe").attr("src","about:blank"),i.fadeOut(),i.trigger("wpformsBuilderInPopupClose",[e,m.formID])},bindUIActionsGeneral:function(){h.on("click",".toggle-smart-tag-display",b.smartTagToggle),h.on("click",".smart-tags-list-display a",b.smartTagInsert),h.on("click",".wpforms-panel-fields-group.unfoldable .wpforms-panel-fields-group-title",b.toggleUnfoldableGroup),h.on("click",".wpforms-field-helper-hide ",b.hideFieldHelper),h.on("input",".wpforms-field-map-table .key-source",function(){var e=w(this).val(),i=w(this).parent().parent().find(".key-destination"),o=i.data("name");e&&i.attr("name",o.replace("{source}",e.replace(/[^0-9a-zA-Z_-]/gi,"")))}),h.on("click",".wpforms-field-map-table .remove",function(e){e.preventDefault(),b.fieldMapTableDeleteRow(e,w(this))}),h.on("click",".wpforms-field-map-table .add",function(e){e.preventDefault(),b.fieldMapTableAddRow(e,w(this))}),w(r).on("wpformsFieldUpdate",b.fieldMapSelect),h.on("input",".wpforms-money-input",function(e){var i=w(this),o=i.val(),t=i[0].selectionStart,r=i[0].selectionEnd;i.val(o.replace(/[^0-9.,]/g,"")),i[0].setSelectionRange(t,r)}),h.on("focusout",".wpforms-money-input",function(e){var i=w(this),o=i.val();if(!o)return o;o=wpf.amountSanitize(o),o=wpf.amountFormat(o);i.val(o)}),h.on("change",".wpforms-panel-field-toggle",function(){var e=w(this);e.prop("disabled")||(e.prop("disabled",!0),b.toggleOptionsGroup(e))}),h.on("change",b.getPaymentsTogglesSelector(),function(e){var i=w(this),o=i.attr("id").replace(/wpforms-panel-field-|-enable|_one_time|_recurring/gi,""),t=w('.wpforms-panel-content-section-notifications [id*="-'+o+'-wrap"]');i.prop("checked")||w("#wpforms-panel-field-"+o+"-enable_one_time").prop("checked")||w("#wpforms-panel-field-"+o+"-enable_recurring").prop("checked")?w("#wpforms-panel-field-settings-disable_entries").prop("checked")?(w.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.payments_entries_off,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}),i.prop("checked",!1)):t.removeClass("wpforms-hidden"):(t.addClass("wpforms-hidden"),t.find('input[id*="-'+o+'"]').prop("checked",!1))}),h.on("change","#wpforms-panel-field-settings-disable_entries",function(e){var i=w(this);i.prop("checked")&&(b.isPaymentsEnabled()?(w.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.payments_on_entries_off,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}),i.prop("checked",!1)):w.alert({title:wpforms_builder.heads_up,content:wpforms_builder.disable_entries,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}))}),h.on("click",".wpforms-image-upload-add",function(e){e.preventDefault();var i=w(this),o=i.parent(),t=wp.media.frames.wpforms_media_frame=wp.media({className:"media-frame wpforms-media-frame",frame:"select",multiple:!1,title:wpforms_builder.upload_image_title,library:{type:"image"},button:{text:wpforms_builder.upload_image_button}});t.on("select",function(){var e=t.state().get("selection").first().toJSON();o.find(".source").val(e.url),o.find(".preview").empty(),o.find(".preview").prepend('<img src="'+e.url+'"><a href="#" title="'+wpforms_builder.upload_image_remove+'" class="wpforms-image-upload-remove"><i class="fa fa-trash-o"></i></a>'),"hide"===i.data("after-upload")&&i.hide(),h.trigger("wpformsImageUploadAdd",[i,o])}),t.open()}),h.on("click",".wpforms-image-upload-remove",function(e){e.preventDefault();e=w(this).parent().parent();e.find(".preview").empty(),e.find(".wpforms-image-upload-add").show(),e.find(".source").val(""),h.trigger("wpformsImageUploadRemove",[w(this),e])}),h.on("blur",".wpforms-notification .wpforms-panel-field-text input",function(){b.validateEmailSmartTags(w(this))}),h.on("blur",".wpforms-notification .wpforms-panel-field-textarea textarea",function(){b.validateEmailSmartTags(w(this))}),h.on("click","#wpforms-builder-mobile-notice .wpforms-fullscreen-notice-button-primary, #wpforms-builder-mobile-notice .close",function(){a.location.href=wpforms_builder.exit_url}),h.on("click","#wpforms-builder-mobile-notice .wpforms-fullscreen-notice-button-secondary",function(){a.location.href=wpf.updateQueryString("force_desktop_view",1,a.location.href)}),w("#wpforms-builder-license-alert .close").on("click",function(){a.location.href=wpforms_builder.exit_url}),w("#wpforms-builder-license-alert .dismiss").on("click",function(e){e.preventDefault(),w("#wpforms-builder-license-alert").remove(),wpCookies.set("wpforms-builder-license-alert","true",3600)}),h.on("change","#wpforms-panel-field-settings-akismet.wpforms-akismet-disabled",function(e){const i=w(this),o=i.data("akismet-status");i.prop("checked")&&w.alert({title:wpforms_builder.heads_up,content:wpforms_builder[o],icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}},onClose:function(){i.prop("checked",!1)}})})},isPaymentsEnabled:function(){var e=!1;return w(b.getPaymentsTogglesSelector()).each(function(){if(w(this).prop("checked"))return!(e=!0)}),e},getPaymentsTogglesSelector:function(){return`.wpforms-panel-content-section-payment-toggle-one-time input,
			.wpforms-panel-content-section-payment-toggle-recurring input,
			#wpforms-panel-field-stripe-enable,
			#wpforms-panel-field-paypal_standard-enable,
			#wpforms-panel-field-authorize_net-enable,
			#wpforms-panel-field-square-enable`},toggleOptionsGroup:function(e){function i(){e.prop("disabled",!1)}var o=e.attr("name"),t=e.attr("type"),r="",o=w('.wpforms-panel-field-toggle-body[data-toggle="'+o+'"]');0===o.length?i():(r="checkbox"!==t&&"radio"!==t||e.prop("checked")?e.val():"0",o.each(function(){var e=w(this);e.attr("data-toggle-value").toString()===r.toString()?e.slideDown("",i):e.slideUp("",i)}))},toggleAllOptionGroups:function(e){(e=e||h||w("#wpforms-builder")||w("body"))&&e.find(".wpforms-panel-field-toggle").each(function(){var e=w(this);e.prop("disabled",!0),b.toggleOptionsGroup(e)})},toggleUnfoldableGroup:function(e){e.preventDefault();var i=w(e.target).closest(".wpforms-panel-fields-group"),e=i.find(".wpforms-panel-fields-group-inner"),o="wpforms_fields_group_"+i.data("group");i.hasClass("opened")?(wpCookies.remove(o),e.stop().slideUp(150,function(){i.removeClass("opened")})):(wpCookies.set(o,"true",2592e3),i.addClass("opened"),e.stop().slideDown(150))},hideFieldHelper:function(e){e.preventDefault(),e.stopPropagation();e=w(".wpforms-field-helper");wpCookies.set("wpforms_field_helper_hide","true",2592e3),e.hide()},smartTagToggle:function(e){e.preventDefault(),g.$focusOutTarget=null;var e=w(this),i=e.closest(".wpforms-panel-field,.wpforms-field-option-row");i.hasClass("smart-tags-toggling")||(i.addClass("smart-tags-toggling"),e.hasClass("smart-tag-showing")?b.removeSmartTagsList(e):b.insertSmartTagsList(e))},removeSmartTagsList:function(e){var i=e.closest(".wpforms-panel-field,.wpforms-field-option-row"),o=i.find(".smart-tags-list-display");e.find("span").text(wpforms_builder.smart_tags_show),o.slideUp("",function(){o.remove(),e.removeClass("smart-tag-showing"),i.removeClass("smart-tags-toggling")})},insertSmartTagsList:function(e){var i,o=e.closest(".wpforms-panel-field,.wpforms-field-option-row"),t=e.closest("label"),r=!0;t.length||(t=o.find("label"),r=!1),i=b.getSmartTagsList(e,-1!==t.attr("for").indexOf("wpforms-field-option-")),(r?t:e).after(i),e.find("span").text(wpforms_builder.smart_tags_hide),o.find(".smart-tags-list-display").slideDown("",function(){e.addClass("smart-tag-showing"),o.removeClass("smart-tags-toggling")})},getSmartTagsList:function(e,i){var o='<ul class="smart-tags-list-display unfoldable-cont">';return(o+=b.getSmartTagsListFieldsElements(e))+b.getSmartTagsListOtherElements(e,i)+"</ul>"},getSmartTagsListFieldsElements:function(e){var i,o=e.data("type"),t=b.getSmartTagsFields(e),r="";if(!["fields","all"].includes(o))return"";if(!t)return'<li class="heading">'+wpforms_builder.fields_unavailable+"</li>";for(i in r+='<li class="heading">'+wpforms_builder.fields_available+"</li>",wpf.orders.fields){var n=wpf.orders.fields[i];t[n]&&(r+=b.getSmartTagsListFieldsElement(t[n]))}return r},getSmartTagsFields:function(e){e=e.data("fields");return e&&e.length?wpf.getFields(e.split(","),!0):wpf.getFields(!1,!0)},getSmartTagsListFieldsElement:function(e){var i=e.label?wpf.encodeHTMLEntities(wpf.sanitizeHTML(e.label)):wpforms_builder.field+" #"+e.id;return'<li><a href="#" data-type="field" data-meta=\''+e.id+"'>"+i+"</a></li>"},getSmartTagsListOtherElements:function(e,i){var o,t,e=e.data("type");if("other"!==e&&"all"!==e)return"";for(t in o='<li class="heading">'+wpforms_builder.other+"</li>",wpforms_builder.smart_tags)i&&-1<wpforms_builder.smart_tags_disabled_for_fields.indexOf(t)||(o+='<li><a href="#" data-type="other" data-meta=\''+t+"'>"+wpforms_builder.smart_tags[t]+"</a></li>");return o},smartTagInsert:function(e){e.preventDefault();var i,e=w(this),o=e.closest(".smart-tags-list-display"),t=o.closest(".wpforms-panel-field,.wpforms-field-option-row"),r=t.find(".toggle-smart-tag-display"),n=t.find("input[type=text], textarea"),s=e.data("meta"),e="field"===e.data("type")?'{field_id="'+s+'"}':"{"+s+"}";"undefined"!=typeof tinyMCE&&(i=tinyMCE.get(n.prop("id")))&&!i.hasFocus()&&i.focus(!0),i&&!i.isHidden()?i.insertContent(e):(n.insertAtCaret(" "+e+" "),n.val(n.val().trim().replace("  "," ")),n.trigger("focus").trigger("input")),o.slideUp("",function(){o.remove()}),r.find("span").text(wpforms_builder.smart_tags_show),t.find(".toggle-smart-tag-display").removeClass("smart-tag-showing")},fieldMapTableDeleteRow:function(e,i){var i=w(i),o=i.closest("tr"),i=i.closest("table"),t=o.closest(".wpforms-builder-settings-block");"1"<i.find("tr").length&&(o.remove(),h.trigger("wpformsFieldMapTableDeletedRow",[t]))},fieldMapTableAddRow:function(e,i){var i=w(i).closest("tr"),o=i.closest(".wpforms-builder-settings-block"),i=i.clone().insertAfter(i);i.find("input").val(""),i.find("select :selected").prop("selected",!1),i.find(".key-destination").attr("name",""),h.trigger("wpformsFieldMapTableAddedRow",[o,i])},fieldMapSelect:function(e,l){w(".wpforms-field-map-select").each(function(e,i){var o,t=w(this),r=t.find("option:selected").val(),n=t.data("field-map-allowed"),s=t.data("field-map-placeholder");if(void 0!==s&&s||(s=wpforms_builder.select_field),t.empty().append(w("<option>",{value:"",text:s})),void 0!==n&&n){if(n=n.split(" "),l&&!w.isEmptyObject(l))for(var a in wpf.orders.fields)Object.prototype.hasOwnProperty.call(wpf.orders.fields,a)&&(a=wpf.orders.fields[a],o="",l[a])&&(o=void 0!==l[a].label&&""!==l[a].label.toString().trim()?wpf.sanitizeHTML(l[a].label.toString().trim()):wpforms_builder.field+" #"+a,0<=w.inArray(l[a].type,n)||0<=w.inArray("all-fields",n))&&t.append(w("<option>",{value:l[a].id,text:o}));r&&t.find('option[value="'+r+'"]').prop("selected",!0);s=t.data("custom-value-support");"boolean"==typeof s&&s&&t.append(w("<option>",{value:"custom_value",text:wpforms_builder.add_custom_value_label,class:"wpforms-field-map-option-custom-value"})),h.trigger("wpformsFieldSelectMapped",[t])}})},validateEmailSmartTags:function(e){var i=e.val();i&&(i=i.replace(/{(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))}/g,function(e){return e.slice(1,-1)}),e.val(i))},iconChoices:{cache:{},config:{colorPropertyName:"--wpforms-icon-choices-color"},init:function(){b.iconChoices.extendJqueryConfirm(),h.on("wpformsBuilderReady",function(e){wpforms_builder.icon_choices.is_active&&!wpforms_builder.icon_choices.is_installed&&(b.iconChoices.openInstallPromptModal(!0),e.preventDefault())}),h.on("change",".wpforms-field-option-row-choices_icons input",b.iconChoices.toggleIconChoices),h.on("change",".wpforms-field-option-row-choices_icons_color .wpforms-color-picker",b.iconChoices.changeIconsColor),h.on("change",".wpforms-field-option-row-choices_icons_style select, .wpforms-field-option-row-choices_icons_size select",function(){var e=w(this).parent().data("field-id"),i=w("#wpforms-field-option-"+e).find(".wpforms-field-option-hidden-type").val();b.fieldChoiceUpdate(i,e)}),h.on("click",".wpforms-field-option-row-choices .choices-list .wpforms-icon-select",b.iconChoices.openIconPickerModal)},toggleIconChoices:function(){var e,i,o=w(this),t=o.is(":checked"),r=o.closest(".wpforms-field-option-row").data("field-id");t&&!wpforms_builder.icon_choices.is_installed?(b.iconChoices.cache.toggle=o,b.iconChoices.openInstallPromptModal()):(i=(o=w("#wpforms-field-option-"+r)).find(`#wpforms-field-option-${r}-choices_images`),e=o.find(`#wpforms-field-option-row-${r}-choices ul`),t&&i.is(":checked")&&i.prop("checked",!1).trigger("change"),o.find(`#wpforms-field-option-row-${r}-dynamic_choices`).toggleClass("wpforms-hidden",t),o.find(`#wpforms-field-option-row-${r}-choices_icons_color`).toggleClass("wpforms-hidden"),o.find(`#wpforms-field-option-row-${r}-choices_icons_size`).toggleClass("wpforms-hidden"),o.find(`#wpforms-field-option-row-${r}-choices_icons_style`).toggleClass("wpforms-hidden"),i=o.find(`#wpforms-field-option-${r}-choices_icons_color`),i=_.isEmpty(i.val())?wpforms_builder.icon_choices.default_color:i.val(),e.prop("style",b.iconChoices.config.colorPropertyName+`: ${i};`),e.toggleClass("show-icons",t),o.find(`#wpforms-field-option-${r}-input_columns`).val(t?"inline":"").trigger("change"),b.fieldChoiceUpdate(o.find(".wpforms-field-option-hidden-type").val(),r))},changeIconsColor:function(){var e=w(this),i=e.parents(".wpforms-field-option-row").data("field-id"),o=w("#wpforms-field-option-"+i),t=o.find(".wpforms-field-option-hidden-type").val(),o=o.find(".wpforms-field-option-row-choices .choices-list"),e=b.getValidColorPickerValue(e);o.prop("style",b.iconChoices.config.colorPropertyName+`: ${e};`),b.fieldChoiceUpdate(t,i)},openInstallPromptModal:function(e=!1){var i=e?wpforms_builder.icon_choices.strings.reinstall_prompt_content:wpforms_builder.icon_choices.strings.install_prompt_content,i=w.confirm({title:wpforms_builder.heads_up,content:i,icon:"fa fa-info-circle",type:"orange",buttons:{continue:{text:wpforms_builder.continue,btnClass:"btn-confirm",keys:["enter"],action:function(){return this.setIcon("fa fa-cloud-download"),this.setTitle(wpforms_builder.icon_choices.strings.install_title),this.setContent(wpforms_builder.icon_choices.strings.install_content),w.each(this.buttons,function(e,i){i.hide()}),b.iconChoices.installIconLibrary(),!1}}},onOpen:function(){!e&&b.iconChoices.cache.toggle&&b.iconChoices.cache.toggle.prop("checked",!1),b.iconChoices.cache.previousModal=this}});e||(i.buttons.cancel={text:wpforms_builder.cancel,keys:["esc"],action:function(){b.iconChoices.cache.toggle.prop("checked",!1)}})},installIconLibrary:function(){var e={nonce:wpforms_builder.nonce,action:"wpforms_icon_choices_install"};w.ajaxSetup({type:"POST",timeout:12e4}),w.post(wpforms_builder.ajax_url,e,function(e){e.success?b.iconChoices.openInstallSuccessModal():b.iconChoices.openInstallErrorModal(e)}).fail(function(e){b.iconChoices.openInstallErrorModal(e)})},openInstallSuccessModal:function(){w.confirm({title:wpforms_builder.done,content:wpforms_builder.icon_choices.strings.install_success_content,icon:"fa fa-check-circle",type:"green",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e;b.iconChoices.cache.toggle&&(b.iconChoices.cache.toggle.prop("checked",!0),e=b.iconChoices.cache.toggle.parents(".wpforms-field-option-row").data("field-id"),(e=h.find(`#wpforms-field-option-${e}-choices_images`)).is(":checked"))&&e.prop("checked",!1),b.formSave(!1).done(function(){a.location.reload()})}}},onOpen:function(){var e;b.iconChoices.cache.toggle&&(e=b.iconChoices.cache.toggle.parents(".wpforms-field-option-row-choices_icons").data("field-id"),h.find(`#wpforms-field-option-${e}-input_columns`).val("inline")),b.iconChoices.cache.previousModal.close()}})},openInstallErrorModal:function(e){w.confirm({title:wpforms_builder.uh_oh,content:wpforms_builder.icon_choices.strings.install_error_content,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){b.iconChoices.cache.toggle?b.iconChoices.cache.toggle.prop("checked",!1):b.formSaveError()}}},onOpen:function(){wpf.debug(e),b.iconChoices.cache.previousModal.close()},onDestroy:function(){delete b.iconChoices.cache.previousModal,delete b.iconChoices.cache.toggle}})},extendJqueryConfirm:function(){a.Jconfirm.prototype._updateContentMaxHeight=function(){var e=w(a).height()-(this.$jconfirmBox.outerHeight()-this.$contentPane.outerHeight())-(this.offsetTop+this.offsetBottom),i=this.contentMaxHeight||e;this.$contentPane.css({"max-height":Math.min(i,e)+"px"})}},openIconPickerModal:function(){var e=w(this);const i={fieldId:e.parents(".wpforms-field-option-row").data("field-id"),choiceId:e.parent().data("key"),selectedIcon:e.find(".source-icon").val(),selectedIconStyle:e.find(".source-icon-style").val()};var e=`
					${wpforms_builder.icon_choices.strings.icon_picker_title}
					<span class="wpforms-icon-picker-description">${wpforms_builder.icon_choices.strings.icon_picker_description}</span>
					<input type="text" placeholder="${wpforms_builder.icon_choices.strings.icon_picker_search_placeholder}" class="search" id="wpforms-icon-picker-search">
				`,o=`
					<div class="wpforms-icon-picker-container" id="wpforms-icon-picker-icons">
						<ul class="wpforms-icon-picker-icons" data-field-id="${i.fieldId}" data-choice-id="${i.choiceId}"></ul>
						<ul class="wpforms-icon-picker-pagination"></ul>
						<p class="wpforms-icon-picker-not-found wpforms-hidden" data-message="${wpforms_builder.icon_choices.strings.icon_picker_not_found}"></>
					</div>`;w.confirm({title:e,titleClass:"wpforms-icon-picker-title",content:o,icon:!1,closeIcon:!0,type:"orange",backgroundDismiss:!0,boxWidth:800,contentMaxHeight:368,smoothContent:!1,buttons:!1,onOpenBefore:function(){this.$body.addClass("wpforms-icon-picker-jconfirm-box"),this.$contentPane.addClass("wpforms-icon-picker-jconfirm-content-pane")},onContentReady:function(){const e=this;b.iconChoices.initIconsList(i),e.$title.find(".search").focus(),e.$content.find(".wpforms-icon-picker-icons").on("click","li",function(){b.iconChoices.selectIcon(e,w(this))})}})},initIconsList:function(o){var e={valueNames:["name"],listClass:"wpforms-icon-picker-icons",page:wpforms_builder.icon_choices.icons_per_page,pagination:{paginationClass:"wpforms-icon-picker-pagination"},item:function(e){var i=e.icon===o.selectedIcon&&e.style===o.selectedIconStyle?'class="selected"':"";return`
								<li data-icon="${e.icon}" data-icon-style="${e.style}"${i}>
									<i class="ic-fa-${e.style} ic-fa-${e.icon}"></i>
									<span class="name">${e.icon}</span>
								</li>`},indexAsync:!0};const t=new List("wpforms-icon-picker-icons",e,wpforms_builder.icon_choices.icons);b.iconChoices.infiniteScrollPagination(t),w("#wpforms-icon-picker-search").on("keyup",function(){t.search(w(this).val(),["name"],function(o,e){for(let e=0,i=t.items.length;e<i;e++)t.items[e].found=new RegExp(o).test(t.items[e].values().icon)})}),t.on("searchComplete",function(){var e=w(".wpforms-icon-picker-not-found");e.html(e.data("message").replace("{keyword}",w("#wpforms-icon-picker-search").val())),e.toggleClass("wpforms-hidden",!_.isEmpty(t.matchingItems))})},infiniteScrollPagination:function(i){let o=1;var e={root:r.querySelector(".wpforms-icon-picker-jconfirm-content-pane"),rootMargin:"600px"};new IntersectionObserver(function(e){e[0].isIntersecting&&(o++,i.show(0,o*wpforms_builder.icon_choices.icons_per_page))},e).observe(r.querySelector(".wpforms-icon-picker-pagination"))},selectIcon:function(e,i){var o=i.parent().data("field-id"),t=i.parent().data("choice-id"),r=i.data("icon"),n=i.data("icon-style"),t=w("#wpforms-field-option-row-"+o+"-choices ul li[data-key="+t+"]"),s=w("#wpforms-field-option-row-"+o+"-choices ul").data("field-type");i.addClass("selected"),i.siblings(".selected").removeClass("selected"),t.find(".wpforms-icon-select span").text(r),t.find(".wpforms-icon-select .ic-fa-preview").removeClass().addClass(`ic-fa-preview ic-fa-${n} ic-fa-`+r),t.find(".wpforms-icon-select .source-icon").val(r),t.find(".wpforms-icon-select .source-icon-style").val(n),b.fieldChoiceUpdate(s,o),e.close()}},dismissNotice:function(){h.on("click",".wpforms-alert-field-not-available .wpforms-dismiss-button",function(e){e.preventDefault();var e=w(this),i=e.closest(".wpforms-alert"),e=e.data("field-id");i.addClass("out"),setTimeout(function(){i.remove()},250),e&&w("#wpforms-field-option-"+e).remove()})},trimFormTitle:function(){var e,i=w(".wpforms-center-form-name");38<i.text().length&&(e=i.text().trim().substring(0,38).split(" ").slice(0,-1).join(" ")+"...",i.text(e))},loadColorPickers:function(){w(".wpforms-color-picker").each(function(){var e=w(this);e.hasClass("minicolors-input")&&e.minicolors("destroy"),e.minicolors({defaultValue:e.data("fallback-color")||""})})},getValidColorPickerValue:function(e){var i=e.minicolors("value"),o=_.isEqual(e.minicolors("rgbObject"),{r:0,g:0,b:0}),t=_.includes(["#000","#000000"],i),e=e.data("fallback-color")||"#000000";return o&&!t?e:i},builderHotkeys:function(){w(r).on("keydown",function(e){if(e.ctrlKey){switch(e.keyCode){case 72:w(g.$helpButton,h).trigger("click");break;case 80:a.open(wpforms_builder.preview_url);break;case 66:w(g.$embedButton,h).trigger("click");break;case 69:a.open(wpforms_builder.entries_url);break;case 83:w(g.$saveButton,h).trigger("click");break;case 81:w(g.$exitButton,h).trigger("click");break;case 191:b.openKeyboardShortcutsModal();break;default:return}return!1}})},openKeyboardShortcutsModal:function(){w(".wpforms-builder-keyboard-shortcuts").length?jconfirm.instances[jconfirm.instances.length-1].close():w.alert({title:wpforms_builder.shortcuts_modal_title,content:wpforms_builder.shortcuts_modal_msg+wp.template("wpforms-builder-keyboard-shortcuts")(),icon:"fa fa-keyboard-o",type:"blue",boxWidth:"550px",smoothContent:!1,buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}},onOpenBefore:function(){this.$body.addClass("wpforms-builder-keyboard-shortcuts")}})},registerTemplates:function(){"undefined"!=typeof WPForms&&WPForms.Admin.Builder.Templates.add(["wpforms-builder-confirmations-message-field","wpforms-builder-conditional-logic-toggle-field"])},exitBack:function(){console.warn('WARNING! Function "WPFormsBuilder.exitBack()" has been deprecated.')}};return b}(document,window,jQuery);WPFormsBuilder.init();