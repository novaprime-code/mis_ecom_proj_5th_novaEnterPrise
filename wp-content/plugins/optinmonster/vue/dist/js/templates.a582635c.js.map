{"version":3,"sources":["webpack:///./node_modules/lodash/orderBy.js","webpack:///./src/pages/Templates.vue?eabb","webpack:///./src/pages/Templates.vue","webpack:///src/pages/Templates.vue","webpack:///./src/pages/Templates.vue?566d","webpack:///./src/pages/Templates.vue?82f9"],"names":["baseOrderBy","isArray","orderBy","collection","iteratees","orders","guard","undefined","module","exports","render","_vm","this","_c","_self","reachedCampaignLimit","attrs","alerts","staticClass","hasTemplates","selectedTemplates","isLoading","style","margin","_e","validType","_v","_s","noTemplatesMessage","staticRenderFns","mapState","mapActions","mapGetters","computed","popularTemplates","featuredTemplates","showableTemplates","filter","template","shouldShowUpsells","mounted","created","document","closeCampaigns","beforeDestroy","methods","listenApiLoaded","forEach","evt","loadApi","script","head","setApiLoaded","applyFilters","order","component"],"mappings":"yHAAA,IAAIA,EAAc,EAAQ,QACtBC,EAAU,EAAQ,QA+BtB,SAASC,EAAQC,EAAYC,EAAWC,EAAQC,GAC9C,OAAkB,MAAdH,EACK,IAEJF,EAAQG,KACXA,EAAyB,MAAbA,EAAoB,GAAK,CAACA,IAExCC,EAASC,OAAQC,EAAYF,EACxBJ,EAAQI,KACXA,EAAmB,MAAVA,EAAiB,GAAK,CAACA,IAE3BL,EAAYG,EAAYC,EAAWC,IAG5CG,EAAOC,QAAUP,G,kCC9CjB,W,yCCAA,IAAIQ,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAQF,EAAII,qBAAsBF,EAAG,4BAA4BA,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,0BAA0B,QAAU,sBAAsB,CAACH,EAAG,gBAAgB,CAACG,MAAM,CAAC,OAASL,EAAIM,UAAUJ,EAAG,MAAM,CAACK,YAAY,qBAAqB,CAACL,EAAG,mBAAmBA,EAAG,qBAAqBA,EAAG,MAAM,CAACK,YAAY,sBAAsB,CAACL,EAAG,2BAA4BF,EAAIQ,aAAcN,EAAG,MAAM,CAACK,YAAY,+BAA+B,CAACL,EAAG,iBAAiB,CAACG,MAAM,CAAC,UAAYL,EAAIS,qBAAsBT,EAAIU,UAAWR,EAAG,cAAc,CAACS,MAAO,CAAEC,OAAQ,YAAcZ,EAAIa,MAAM,GAAIb,EAAIU,UAAWR,EAAG,MAAM,CAACK,YAAY,yBAAyB,CAACL,EAAG,MAAM,CAACA,EAAG,eAAe,CAACK,YAAY,YAAY,KAAKL,EAAG,MAAM,CAACK,YAAY,0BAA0B,CAACL,EAAG,aAAa,CAACG,MAAM,CAAC,KAAOL,EAAIc,UAAY,OAAS,SAAS,CAACZ,EAAG,MAAM,CAACK,YAAY,iBAAiB,CAACP,EAAIe,GAAG,IAAIf,EAAIgB,GAAGhB,EAAIiB,oBAAoB,UAAU,IAAI,IAAI,GAAGf,EAAG,mCAAmCA,EAAG,iCAAiCA,EAAG,8BAA8B,IAEjkCgB,EAAkB,G,uFC+CtB,MAAM,SAANC,aAAAC,aAAAC,GAAA,4BAEe,OACfC,aACA,GACA,aACA,SACA,OACA,UACA,iBAEA,uEACAhB,SACA,4CAEAI,YACA,mDAEAa,mBACA,sCAEA,qCAEAC,oBACA,uCAEA,qCAEAC,oBACA,gBACA,yBACA,wCAIA,+EACA,UACAC,OAAAC,GACA,kBAGA,0DACAD,OAAAC,IACA,uCACAA,UACA,SAEA,MACA,SAGA,sCAEA,kBACA,0BAIA,sBAEAlB,oBACA,wCACA,oBACAkB,yBACAA,2BAGAnB,eACA,sCAEAoB,oBACA,wCACA,qCAGAX,qBACA,sBACA,qDACA,sFAEAb,uBACA,kCACA,SAEA,kEACA,qEAEA,aAGAyB,UACA,uCACA,uDAEAC,UACA,uBAGAC,yDAGAA,sDAGAA,kDAGAA,0DACAA,2DAEA,0BACA,SACA,8BACA,4BAEA,wBACAC,iBACA,qDACA,oDAIA,+DAEA,gBAEAC,gBAEAF,4DAGAA,yDAGAA,qDAGAA,6DACAA,+DAEAG,YACA,yBACAC,kBAAA,gFACA,CACA,cACA,eACA,oBACA,oBACAC,QAAAC,sCAEAC,UACA,yDACA,KACA,OAEA,2EACAC,mCACAA,yBACAA,+BACAA,yBACAA,WACAA,wBACAA,qBACA,2BACAA,oEAGAC,kBAEAC,eACA,4CACA,2CAEAC,gBACA,uCACA,kDAEAC,SACA,gBACA,8FCpOmV,I,wBCQ/UC,EAAY,eACd,EACA7C,EACAmB,GACA,EACA,KACA,KACA,MAIa,aAAA0B,E","file":"js/templates.a582635c.js","sourcesContent":["var baseOrderBy = require('./_baseOrderBy'),\n    isArray = require('./isArray');\n\n/**\n * This method is like `_.sortBy` except that it allows specifying the sort\n * orders of the iteratees to sort by. If `orders` is unspecified, all values\n * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n * descending or \"asc\" for ascending sort order of corresponding values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @param {string[]} [orders] The sort orders of `iteratees`.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 34 },\n *   { 'user': 'fred',   'age': 40 },\n *   { 'user': 'barney', 'age': 36 }\n * ];\n *\n * // Sort by `user` in ascending order and by `age` in descending order.\n * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n */\nfunction orderBy(collection, iteratees, orders, guard) {\n  if (collection == null) {\n    return [];\n  }\n  if (!isArray(iteratees)) {\n    iteratees = iteratees == null ? [] : [iteratees];\n  }\n  orders = guard ? undefined : orders;\n  if (!isArray(orders)) {\n    orders = orders == null ? [] : [orders];\n  }\n  return baseOrderBy(collection, iteratees, orders);\n}\n\nmodule.exports = orderBy;\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Templates.vue?vue&type=style&index=0&id=0c74f97d&prod&lang=scss&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.reachedCampaignLimit)?_c('templates-limit-exceeded'):_c('core-page',{attrs:{\"title\":\"Select a Campaign Type:\",\"classes\":\"templates-wrapper\"}},[_c('common-alerts',{attrs:{\"alerts\":_vm.alerts}}),_c('div',{staticClass:\"templates-content\"},[_c('templates-types'),_c('templates-filters'),_c('div',{staticClass:\"omapi-content-area\"},[_c('templates-upsell-alerts'),(_vm.hasTemplates)?_c('div',{staticClass:\"omapi-template-listing-wrap\"},[_c('templates-grid',{attrs:{\"templates\":_vm.selectedTemplates}}),(_vm.isLoading)?_c('svg-loading',{style:({ margin: '0 auto' })}):_vm._e()],1):(_vm.isLoading)?_c('div',{staticClass:\"archie-loader-wrapper\"},[_c('div',[_c('core-loading',{staticClass:\"loader\"})],1)]):_c('div',{staticClass:\"no-templates-available\"},[_c('core-alert',{attrs:{\"type\":_vm.validType ? 'info' : 'warn'}},[_c('div',{staticClass:\"alert-message\"},[_vm._v(\" \"+_vm._s(_vm.noTemplatesMessage)+\" \")])])],1)],1)],1),_c('campaigns-modal-create-campaign'),_c('templates-modal-not-connected'),_c('templates-modal-no-access')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<templates-limit-exceeded v-if=\"reachedCampaignLimit\" />\n\t<core-page v-else title=\"Select a Campaign Type:\" classes=\"templates-wrapper\">\n\t\t<common-alerts :alerts=\"alerts\" />\n\t\t<div class=\"templates-content\">\n\t\t\t<templates-types />\n\t\t\t<templates-filters />\n\n\t\t\t<div class=\"omapi-content-area\">\n\t\t\t\t<templates-upsell-alerts />\n\n\t\t\t\t<div v-if=\"hasTemplates\" class=\"omapi-template-listing-wrap\">\n\t\t\t\t\t<templates-grid :templates=\"selectedTemplates\" />\n\t\t\t\t\t<svg-loading v-if=\"isLoading\" :style=\"{ margin: '0 auto' }\"></svg-loading>\n\t\t\t\t</div>\n\n\t\t\t\t<div v-else-if=\"isLoading\" class=\"archie-loader-wrapper\">\n\t\t\t\t\t<div><core-loading class=\"loader\" /></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div v-else class=\"no-templates-available\">\n\t\t\t\t\t<core-alert :type=\"validType ? 'info' : 'warn'\">\n\t\t\t\t\t\t<div class=\"alert-message\">\n\t\t\t\t\t\t\t{{ noTemplatesMessage }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</core-alert>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<campaigns-modal-create-campaign />\n\t\t<templates-modal-not-connected />\n\t\t<templates-modal-no-access />\n\t</core-page>\n</template>\n\n<script lang=\"js\">\nimport get from 'lodash/get'\nimport orderBy from 'lodash/orderBy'\nimport upperFirst from 'lodash/upperFirst'\n\nimport {\n\tcloseCampaigns,\n\tmaybeMobiilePreview,\n\tmaybeEndMobiilePreview,\n\tsetDemo,\n\tsetPreview,\n\tenableBgClick,\n} from '@/utils/om-api'\nimport { createNamespacedHelpers } from 'vuex'\nconst { mapState, mapActions, mapGetters } = createNamespacedHelpers('templates')\n\nexport default  {\n\tcomputed : {\n\t\t...mapState([\n\t\t\t'activeType',\n\t\t\t'search',\n\t\t\t'sort',\n\t\t\t'popular',\n\t\t\t'templates',\n\t\t]),\n\t\t...mapGetters([ 'typePermitted', 'featured', 'filters', 'filterGamified', 'validType' ]),\n\t\talerts () {\n\t\t\treturn this.$get('$store.state.alerts', [])\n\t\t},\n\t\tisLoading () {\n\t\t\treturn this.$store.getters.isLoading('templates')\n\t\t},\n\t\tpopularTemplates () {\n\t\t\tconst popular = this.popular[this.activeType]\n\n\t\t\treturn popular && popular.length ? this.order(popular) : []\n\t\t},\n\t\tfeaturedTemplates () {\n\t\t\tconst featured = this.featured[this.activeType]\n\n\t\t\treturn featured && featured.length ? this.order(featured) : []\n\t\t},\n\t\tshowableTemplates () {\n\t\t\tconst filterPasses = (key, value) => {\n\t\t\t\treturn this.filters[key].length\n\t\t\t\t\t? !this.filters[key].find(f => !value.includes(f))\n\t\t\t\t\t: true\n\t\t\t}\n\n\t\t\tconst prop = [ 'popular', 'featured' ].includes(this.sort) ? `${this.sort}Templates` : 'templates'\n\t\t\tconst templates = this[ prop ]\n\t\t\t\t.filter((template) => {\n\t\t\t\t\tif ('' === this.search) {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t\treturn template.name.toLowerCase().includes(this.search.toLowerCase())\n\t\t\t\t}).filter((template) => {\n\t\t\t\t\tconst device = 'mobile' === this.filters.device\n\t\t\t\t\t\t? template.mobile\n\t\t\t\t\t\t: !template.mobile\n\n\t\t\t\t\tif (!device) {\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\n\t\t\t\t\tconst taxonomies = [ 'goals', 'categories', 'tags' ]\n\n\t\t\t\t\treturn !taxonomies.find(t => {\n\t\t\t\t\t\treturn !filterPasses(t, template[t].map(term => term.id))\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\treturn this.order(templates)\n\t\t},\n\t\tselectedTemplates () {\n\t\t\treturn this.showableTemplates.filter(template => {\n\t\t\t\treturn this.filterGamified\n\t\t\t\t\t? template.tags.find(tag => 1 === tag.id)\n\t\t\t\t\t: template.type === this.activeType\n\t\t\t})\n\t\t},\n\t\thasTemplates () {\n\t\t\treturn this.selectedTemplates.length\n\t\t},\n\t\tshouldShowUpsells () {\n\t\t\treturn this.$store.getters.connected\n\t\t\t\t? !this.typePermitted(this.activeType)\n\t\t\t\t: false\n\t\t},\n\t\tnoTemplatesMessage () {\n\t\t\treturn this.validType\n\t\t\t\t? 'No templates available for your current selection.'\n\t\t\t\t: `${upperFirst(this.activeType)} is not a valid type. Please select one of the options above.`\n\t\t},\n\t\treachedCampaignLimit () {\n\t\t\tif (!this.$store.getters.connected) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tconst total = this.$get('$store.state.campaigns.totalCampaignsCount', 0)\n\t\t\tconst limit = get(this.$store.getters.userAttribute('limits', {}), 'campaigns', 10)\n\n\t\t\treturn total > limit\n\t\t},\n\t},\n\tmounted () {\n\t\tthis.fetchTemplateData().catch(() => {})\n\t\tthis.$bus.$emit('dashboard-view-mounted', 'templates')\n\t},\n\tcreated () {\n\t\tthis.listenApiLoaded()\n\n\t\t// Ensure campaigns are flagged as demos.\n\t\tdocument.addEventListener('om.Main.getCampaigns', setDemo)\n\n\t\t// Make previews closeable by clicking background.\n\t\tdocument.addEventListener('om.Campaigns.init', enableBgClick)\n\n\t\t// Disable form fields\n\t\tdocument.addEventListener('om.Optin.init', setPreview)\n\n\t\t// Handle mobile template previews\n\t\tdocument.addEventListener('om.Campaign.afterShow', maybeMobiilePreview)\n\t\tdocument.addEventListener('om.Campaign.startClose', maybeEndMobiilePreview)\n\n\t\tthis.$store.subscribe((mutation) => {\n\t\t\tconst ignore = [\n\t\t\t\t'templates/setLoadingPreview',\n\t\t\t\t'templates/setPreviewing',\n\t\t\t]\n\t\t\tif (-1 === ignore.indexOf(mutation.type)) {\n\t\t\t\tcloseCampaigns()\n\t\t\t\tthis.$store.commit('templates/setLoadingPreview', '')\n\t\t\t\tthis.$store.commit('templates/setPreviewing', '')\n\t\t\t}\n\t\t})\n\n\t\tthis.$store.dispatch('campaigns/fetchDashboard').catch(() => {})\n\n\t\tthis.loadApi()\n\t},\n\tbeforeDestroy () {\n\t\t// Ensure campaigns are flagged as demos.\n\t\tdocument.removeEventListener('om.Main.getCampaigns', setDemo)\n\n\t\t// Make previews closeable by clicking background.\n\t\tdocument.removeEventListener('om.Campaigns.init', enableBgClick)\n\n\t\t// Disable form fields\n\t\tdocument.removeEventListener('om.Optin.init', setPreview)\n\n\t\t// Handle mobile template previews\n\t\tdocument.removeEventListener('om.Campaign.afterShow', maybeMobiilePreview)\n\t\tdocument.removeEventListener('om.Campaign.startClose', maybeEndMobiilePreview)\n\t},\n\tmethods : {\n\t\t...mapActions([ 'fetchTemplateData' ]),\n\t\tlistenApiLoaded (cb = 'addEventListener') {\n\t\t\t[\n\t\t\t\t'om.Api.init',\n\t\t\t\t'om.Main.init',\n\t\t\t\t'om.Campaigns.init',\n\t\t\t\t'om.Campaign.init',\n\t\t\t].forEach(evt => document[cb](evt, this.setApiLoaded))\n\t\t},\n\t\tloadApi () {\n\t\t\tlet script = document.getElementById('omwpapi-templates-apijs')\n\t\t\tif (script) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst head   = document.getElementsByTagName('head')[0] || document.documentElement\n\t\t\tscript = document.createElement('script')\n\t\t\tscript.type            = 'text/javascript'\n\t\t\tscript.id              = 'omwpapi-templates-apijs'\n\t\t\tscript.src             = this.$urls.apiJs()\n\t\t\tscript.async           = true\n\t\t\tscript.dataset.account = 56690\n\t\t\tscript.dataset.user    = 50374\n\t\t\tif (!this.$env.isProduction()) {\n\t\t\t\tscript.dataset.env = this.$env.isDevelopment() ? 'dev' : this.$env.currentEnv\n\t\t\t}\n\n\t\t\thead.appendChild(script)\n\t\t},\n\t\tsetApiLoaded () {\n\t\t\tthis.listenApiLoaded('removeEventListener')\n\t\t\tthis.$store.commit('templates/apiLoaded')\n\t\t},\n\t\tapplyFilters (filters) {\n\t\t\tthis.$bus.$emit('applied-bulk-filter')\n\t\t\tthis.$store.commit('templates/appliedFilters', filters)\n\t\t},\n\t\torder (templates) {\n\t\t\treturn orderBy(templates, (template) => {\n\t\t\t\treturn 'recent' === this.sort || 'featured' === this.sort ? -this.$moment(template.created_at).valueOf() : template.name\n\t\t\t})\n\t\t},\n\t},\n\n};\n</script>\n<style lang=\"scss\">\n@import '../assets/scss/variables';\n@import '../assets/scss/pages/templates';\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Templates.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Templates.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Templates.vue?vue&type=template&id=0c74f97d&\"\nimport script from \"./Templates.vue?vue&type=script&lang=js&\"\nexport * from \"./Templates.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Templates.vue?vue&type=style&index=0&id=0c74f97d&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}